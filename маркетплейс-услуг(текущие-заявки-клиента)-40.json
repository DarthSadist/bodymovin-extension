{"createdAt":"2023-04-21T23:17:13.724Z","updatedAt":"2023-05-11T04:38:42.000Z","id":"40","name":"–ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å —É—Å–ª—É–≥(–¢–µ–∫—É—â–∏–µ –∑–∞—è–≤–∫–∏ –∫–ª–∏–µ–Ω—Ç–∞)","active":true,"nodes":[{"parameters":{"path":"0bad83c6-9da5-4e07-a5b7-4e9cd9854958","options":{}},"id":"a5250991-9ddb-45ac-b9fc-a33119840609","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[220,460],"webhookId":"0bad83c6-9da5-4e07-a5b7-4e9cd9854958"},{"parameters":{"jsCode":"const inputData = items[0].json;\n\n// –°–æ–∑–¥–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏–π x, msgid –∏ klient_otvet_order\nlet xValue;\nlet msgidValue;\nlet klientOtvetOrderValue;\n\n// –ü—Ä–æ–≤–µ—Ä—è–µ–º, –æ–ø—Ä–µ–¥–µ–ª–µ–Ω –ª–∏ –æ–±—ä–µ–∫—Ç inputData.query, –∏ –ø–µ—Ä–µ–±–∏—Ä–∞–µ–º –µ–≥–æ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ\nif (inputData.query && inputData.query.variables) {\n  inputData.query.variables.forEach((variable) => {\n    if (variable.name === 'x') {\n      xValue = variable.value;\n    } else if (variable.name === 'msgid') {\n      msgidValue = variable.value;\n    } else if (variable.name === 'klient_otvet_order') {\n      klientOtvetOrderValue = variable.value;\n    }\n  });\n}\n\n// –í–æ–∑–≤—Ä–∞—â–∞–µ–º –æ–±—ä–µ–∫—Ç —Å –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ —Å–≤–æ–π—Å—Ç–≤–∞–º–∏ x, msgid –∏ klient_otvet_order\nreturn [{ json: { x: xValue, msgid: msgidValue, klient_otvet_order: klientOtvetOrderValue } }]; "},"id":"d83aad75-498f-47fe-a0ac-9edf59b3a3d6","name":"Code","type":"n8n-nodes-base.code","typeVersion":1,"position":[380,460]},{"parameters":{"dataType":"string","value1":"={{ $json[\"x\"] }}","rules":{"rules":[{"value2":"1"},{"value2":"2","output":1},{"value2":"3","output":2},{"value2":"4","output":3},{"value2":"5","output":3},{"value2":"6","output":2}]}},"id":"029ddf78-08a6-4789-a972-b6cfe0c39301","name":"Switch","type":"n8n-nodes-base.switch","typeVersion":1,"position":[520,460]},{"parameters":{"documentId":{"__rl":true,"value":"1_mVTlW_BvNIQ30QbtAC59sPq3-ynnggfG01WI4A0WjE","mode":"list","cachedResultName":"–ó–∞–∫–∞–∑—ã –∫–ª–∏–µ–Ω—Ç–æ–≤(–º–∞—Ä–∫–µ—Ç–ø–ª—ç–π—Å —É—Å–ª—É–≥)","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1_mVTlW_BvNIQ30QbtAC59sPq3-ynnggfG01WI4A0WjE/edit?usp=drivesdk"},"sheetName":{"__rl":true,"value":"gid=0","mode":"list","cachedResultName":"–ó–∞–∫–∞–∑—ã –∫–ª–∏–µ–Ω—Ç–æ–≤(–º–∞—Ä–∫–µ—Ç–ø–ª—ç–π—Å —É—Å–ª—É–≥)","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1_mVTlW_BvNIQ30QbtAC59sPq3-ynnggfG01WI4A0WjE/edit#gid=0"},"filtersUI":{"values":[{"lookupColumn":"Telegram ID","lookupValue":"={{ $node[\"Webhook\"].json[\"query\"][\"telegram_id\"] }}"}]},"options":{"returnAllMatches":"returnAllMatches"}},"id":"0b1d8d94-9c03-4eba-9836-51d8b1dee44b","name":"Google Sheets","type":"n8n-nodes-base.googleSheets","typeVersion":3,"position":[180,200],"alwaysOutputData":true,"credentials":{"googleSheetsOAuth2Api":{"id":"27","name":"Google Sheets account"}}},{"parameters":{"jsCode":"let aggregatedText = '';\n\nitems.forEach(item => {\n  const rowNumber = item.json.row_number;\n  const specialist = item.json['–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç'];\n  let description = item.json['–ó–∞–¥–∞—á–∞'];\n  let date = item.json['–î–∞—Ç–∞ –∑–∞–∫–∞–∑–∞'];\n  let time = item.json['–í—Ä–µ–º—è –∑–∞–∫–∞–∑–∞'];\n  let funnel = item.json['–í–æ—Ä–æ–Ω–∫–∞'];\n  const masterAppointed = item.json['–ú–∞—Å—Ç–µ—Ä –Ω–∞–∑–Ω–∞—á–µ–Ω'];\n  let cost = '';\n  let additionalMaterials = '';\n  let comment = '';\n  let photo = '';\n  let showAdditionalInfo = false;\n\n  if (funnel === \"6. —Ü–µ–Ω–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∞ –Ω–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç—É\") {\n      date = item.json['–î–∞—Ç–∞ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è'];\n      time = item.json['–í—Ä–µ–º—è –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è'];\n      description = item.json['–û–ø–∏—Å–∞–Ω–∏–µ —Ä–∞–±–æ—Ç'];\n      cost = item.json['–°—Ç–æ–∏–º–æ—Å—Ç—å —Ä–∞–±–æ—Ç'] || \"–ù–µ—Ç\";\n      additionalMaterials = item.json['–î–æ–ø. –º–∞—Ç–µ—Ä–∏–∞–ª—ã'] || \"–ù–µ—Ç\";\n      comment = item.json['–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π'] || \"–ù–µ—Ç\";\n      photo = item.json['–§–æ—Ç–æ'] || \"–ù–µ—Ç\";\n  } else if (funnel === \"7. –∫–ª–∏–µ–Ω—Ç –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª\" || funnel === \"10. –∫–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–∏–ª –Ω–∞ –¥–æ—Ä–∞–±–æ—Ç–∫—É\") {\n      cost = item.json['–°—Ç–æ–∏–º–æ—Å—Ç—å —Ä–∞–±–æ—Ç'] || \"–ù–µ—Ç\";\n      additionalMaterials = item.json['–î–æ–ø. –º–∞—Ç–µ—Ä–∏–∞–ª—ã'] || \"–ù–µ—Ç\";\n      comment = item.json['–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π'] || \"–ù–µ—Ç\";\n      photo = item.json['–§–æ—Ç–æ'] || \"–ù–µ—Ç\";\n      showAdditionalInfo = true;\n  } else if (funnel === \"3. –∑–∞—è–≤–∫–∞ –ø–µ—Ä–µ–¥–∞–Ω–∞ –º–∞—Å—Ç–µ—Ä–∞–º\") {\n      funnel = 'ü´¥ –∑–∞—è–≤–∫–∞ –ø–µ—Ä–µ–¥–∞–Ω–∞ –º–∞—Å—Ç–µ—Ä–∞–º';\n  }\n\n  if (funnel.startsWith('4.')) {\n    funnel = 'üìù –º–∞—Å—Ç–µ—Ä –Ω–∞–∑–Ω–∞—á–µ–Ω';\n  } else if (funnel.startsWith('5.')) {\n    funnel = 'üö∂ 1—ã–π –≤–∏–∑–∏—Ç –º–∞—Å—Ç–µ—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω';\n  } else if (funnel.startsWith('6.')) {\n    funnel = 'üí≥ —Ü–µ–Ω–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∞ –Ω–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç—É';\n  } else if (funnel.startsWith('7.')) {\n    funnel = '‚úÖ –∫–ª–∏–µ–Ω—Ç –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª';\n  } else if (funnel.startsWith('10.')) {\n    funnel = 'üîß –∫–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–∏–ª –Ω–∞ –¥–æ—Ä–∞–±–æ—Ç–∫—É';\n  }\n\n  aggregatedText += `‚û§ <b>–ó–∞—è–≤–∫–∞ ‚Ññ${rowNumber}</b>\\n\\n`;\n  aggregatedText += `‚Ä¢ üë§<b>–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–π —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç:</b> <i>${specialist}</i>\\n`;\n  aggregatedText += `‚Ä¢ üìÉ<b>–û–ø–∏—Å–∞–Ω–∏–µ —Ä–∞–±–æ—Ç:</b> <i>${description}</i>\\n`;\n  aggregatedText += `‚Ä¢ üìÖ<b>–î–∞—Ç–∞:</b> <i>${date}</i>\\n`;\n  aggregatedText += `‚Ä¢ üï∞<b>–í—Ä–µ–º—è:</b> <i>${time}</i>\\n`;\n  aggregatedText += `‚Ä¢ üõ† <b>–°—Ç–∞—Ç—É—Å –∑–∞—è–≤–∫–∏:</b> <i>${funnel}</i>\\n`;\n\n  if (cost) {\n    aggregatedText += `‚Ä¢ üí∞ <b>–°—Ç–æ–∏–º–æ—Å—Ç—å —Ä–∞–±–æ—Ç:</b> <i>${cost}</i>\\n`;\n  }\n  \n  if (additionalMaterials) {\n    aggregatedText += `‚Ä¢ üõí <b>–î–æ–ø. –º–∞—Ç–µ—Ä–∏–∞–ª—ã:</b> <i>${additionalMaterials}</i>\\n`;\n  }\n  \n  if (comment) {\n    aggregatedText += `‚Ä¢ üí¨ <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:</b> <i>${comment}</i>\\n`;\n  }\n  \n  if (photo) {\n    aggregatedText += `‚Ä¢ üì∑ <b>–§–æ—Ç–æ:</b> <i>${photo}</i>\\n`;\n  }\n\n  if (showAdditionalInfo && masterAppointed) {\n    aggregatedText += `‚Ä¢ üß∞ <b>–ú–∞—Å—Ç–µ—Ä –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å:</b><i>üëã ${masterAppointed}</i>\\n`;\n  } else if (masterAppointed) {\n    aggregatedText += `‚Ä¢ üß∞ <b>–í–∞–º –Ω–∞–∑–Ω–∞—á–µ–Ω –º–∞—Å—Ç–µ—Ä: </b><i>üëã ${masterAppointed}</i>\\n`;\n  }\n\n  aggregatedText += '\\n';\n});\n\nreturn [{json: {aggregatedText: aggregatedText}}];"},"id":"0c548a50-8843-4646-9511-4c56d0125789","name":"—Ç–µ–∫—Å—Ç","type":"n8n-nodes-base.code","typeVersion":1,"position":[1300,80]},{"parameters":{"jsCode":"const buttons = items.map(item => {\n  const rowNumber = item.json['row_number'];\n  const createdDate = item.json['–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è']; // –ø–æ–ª—É—á–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è\n  return {\n    text: `üü¢ –ó–∞—è–≤–∫–∞ ‚Ññ${rowNumber}`,\n    callback_data: createdDate // –∏—Å–ø–æ–ª—å–∑—É–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è –≤ –∫–∞—á–µ—Å—Ç–≤–µ callback_data\n  };\n});\n\nconst keyboardRows = buttons.reduce((resultArray, item, index) => { \n  const chunkIndex = Math.floor(index / 3);\n\n  if(!resultArray[chunkIndex]) {\n    resultArray[chunkIndex] = [] // –Ω–∞—á–∏–Ω–∞–µ–º –Ω–æ–≤—ã–π —Ä—è–¥\n  }\n\n  resultArray[chunkIndex].push(item);\n\n  return resultArray;\n}, []);\n\nconst keyboard = {\n  inline_keyboard: [...keyboardRows, [\n    {\n      text: \"üîµ –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç\",\n      callback_data: \"–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç\"\n    }\n  ]]\n};\n\nreturn { json: { reply_markup: JSON.stringify(keyboard) } };"},"id":"5ff0f765-246a-42f2-98a7-8a4f57d0fef4","name":"–∫–Ω–æ–ø–∫–∏","type":"n8n-nodes-base.code","typeVersion":1,"position":[1300,220]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $json[\"isEmpty\"] }}","operation":"=equal","value2":true}]}},"id":"15458746-cb32-481b-9e1a-9c98b29e1e98","name":"IF","type":"n8n-nodes-base.if","typeVersion":1,"position":[660,200]},{"parameters":{"mode":"combine","combinationMode":"multiplex","options":{}},"id":"d950f313-61c6-4be9-9264-0424fbd1a3d6","name":"Merge","type":"n8n-nodes-base.merge","typeVersion":2,"position":[1660,120]},{"parameters":{"url":"https://api.telegram.org/bot6255776658:AAE7tUXJpMBh9ZZN7BhV03bPvyfD5g3peQU/sendMessage","sendQuery":true,"queryParameters":{"parameters":[{"name":"chat_id","value":"={{ $node[\"Webhook\"].json[\"query\"][\"telegram_id\"] }}"},{"name":"=text","value":"=<b>–í–∞—à–∏ —Ç–µ–∫—É—â–∏–µ –∑–∞—è–≤–∫–∏</b>\n\n{{ $node[\"Merge\"].json[\"aggregatedText\"] }}\n\n\n<b>‚öô –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É –≤—ã–±—Ä–∞–Ω–Ω–æ–π –≤–∞–º–∏ –∑–∞—è–≤–∫–∏</b>üëá"},{"name":"reply_markup","value":"={{ $node[\"Merge\"].json[\"reply_markup\"] }}"},{"name":"parse_mode","value":"HTML"}]},"options":{}},"id":"7a5cc5d0-8f38-4ef3-9ebb-0177a88d7a65","name":"HTTP Request","type":"n8n-nodes-base.httpRequest","typeVersion":4,"position":[1940,120]},{"parameters":{"jsCode":"const inputData = items;\n\nconst filteredData = inputData.filter((item) => {\n  const funnelValue = item.json[\"–í–æ—Ä–æ–Ω–∫–∞\"];\n  return (\n    funnelValue !== \"8. –∫–ª–∏–µ–Ω—Ç –æ—Ç–∫–∞–∑–∞–ª—Å—è\" &&\n    funnelValue !== \"9. –∫–ª–∏–µ–Ω—Ç –ø—Ä–∏–Ω—è–ª —Ä–∞–±–æ—Ç—É\"\n  );\n});\n\nif (Object.keys($node['Google Sheets'].json).length === 0 || filteredData.length === 0) {\n  return [{json: {isEmpty: true}}];\n} else {\n  return filteredData;\n}"},"id":"6955baf2-dbfc-4405-8a96-875f84210cf2","name":"—Ñ–∏–ª—å—Ç—Ä","type":"n8n-nodes-base.code","typeVersion":1,"position":[440,200]},{"parameters":{"documentId":{"__rl":true,"value":"1_mVTlW_BvNIQ30QbtAC59sPq3-ynnggfG01WI4A0WjE","mode":"list","cachedResultName":"–ó–∞–∫–∞–∑—ã –∫–ª–∏–µ–Ω—Ç–æ–≤(–º–∞—Ä–∫–µ—Ç–ø–ª—ç–π—Å —É—Å–ª—É–≥)","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1_mVTlW_BvNIQ30QbtAC59sPq3-ynnggfG01WI4A0WjE/edit?usp=drivesdk"},"sheetName":{"__rl":true,"value":"gid=0","mode":"list","cachedResultName":"–ó–∞–∫–∞–∑—ã –∫–ª–∏–µ–Ω—Ç–æ–≤(–º–∞—Ä–∫–µ—Ç–ø–ª—ç–π—Å —É—Å–ª—É–≥)","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1_mVTlW_BvNIQ30QbtAC59sPq3-ynnggfG01WI4A0WjE/edit#gid=0"},"filtersUI":{"values":[{"lookupColumn":"–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è","lookupValue":"={{ $node[\"Code\"].json[\"klient_otvet_order\"] }}"}]},"options":{}},"id":"ca7cd60f-176f-4584-a576-8f5b5188115c","name":"Google Sheets1","type":"n8n-nodes-base.googleSheets","typeVersion":3,"position":[780,460],"credentials":{"googleSheetsOAuth2Api":{"id":"27","name":"Google Sheets account"}}},{"parameters":{"jsCode":"let aggregatedText = '';\n\nitems.forEach(item => {\n  const rowNumber = item.json.row_number;\n  const specialist = item.json['–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç'];\n  const task = item.json['–ó–∞–¥–∞—á–∞'];\n  const date = item.json['–î–∞—Ç–∞ –∑–∞–∫–∞–∑–∞'];\n  const time = item.json['–í—Ä–µ–º—è –∑–∞–∫–∞–∑–∞'];\n  let funnel = item.json['–í–æ—Ä–æ–Ω–∫–∞'];\n  const masterAppointed = item.json['–ú–∞—Å—Ç–µ—Ä –Ω–∞–∑–Ω–∞—á–µ–Ω'];\n\n  if (funnel.startsWith('4.')) {\n    funnel = 'üìù –º–∞—Å—Ç–µ—Ä –Ω–∞–∑–Ω–∞—á–µ–Ω';\n  } else if (funnel.startsWith('5.')) {\n    funnel = 'üö∂ 1—ã–π –≤–∏–∑–∏—Ç –º–∞—Å—Ç–µ—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω';\n  } else if (funnel.startsWith('6.')) {\n    funnel = 'üí≥ —Ü–µ–Ω–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∞ –Ω–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç—É';\n  } else if (funnel.startsWith('7.')) {\n    funnel = '‚úÖ –∫–ª–∏–µ–Ω—Ç –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª';\n  } else if (funnel.startsWith('10.')) {\n    funnel = 'ü™õ –∫–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–∏–ª –Ω–∞ –¥–æ—Ä–∞–±–æ—Ç–∫—É';\n  }\n\n  aggregatedText += `‚û§ <b>–ó–∞—è–≤–∫–∞ ‚Ññ${rowNumber}</b>\\n\\n`;\n  aggregatedText += `‚Ä¢ üë§<b>–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–π —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç:</b> <i>${specialist}</i>\\n`;\n  aggregatedText += `‚Ä¢ üìÉ<b>–ó–∞–¥–∞—á–∞:</b> <i>${task}</i>\\n`;\n  aggregatedText += `‚Ä¢ üìÖ<b>–î–∞—Ç–∞:</b> <i>${date}</i>\\n`;\n  aggregatedText += `‚Ä¢ üï∞<b>–í—Ä–µ–º—è:</b> <i>${time}</i>\\n`;\n  aggregatedText += `‚Ä¢ üõ† <b>–°—Ç–∞—Ç—É—Å –∑–∞—è–≤–∫–∏:</b> <i>${funnel}</i>\\n`;\n\n  if (masterAppointed) {\n    aggregatedText += `‚Ä¢ üß∞ <b>–í–∞–º –Ω–∞–∑–Ω–∞—á–µ–Ω –º–∞—Å—Ç–µ—Ä: </b><i>üëã ${masterAppointed}</i>\\n`\n  }\n\n  aggregatedText += '\\n';\n});\n\nreturn [{json: {aggregatedText: aggregatedText}}];"},"id":"a69c150a-8fc5-4c95-b272-a40d7aede803","name":"—Ç–µ–∫—Å—Ç1","type":"n8n-nodes-base.code","typeVersion":1,"position":[1780,840]},{"parameters":{"operation":"deleteMessage","chatId":"={{ $node[\"Webhook\"].json[\"query\"][\"telegram_id\"] }}","messageId":"={{ $node[\"Code\"].json[\"msgid\"] }}"},"id":"1a4033ad-a332-49b8-9315-73331dd55db5","name":"—É–¥–∞–ª–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ","type":"n8n-nodes-base.telegram","typeVersion":1,"position":[620,-80],"credentials":{"telegramApi":{"id":"33","name":"–ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å —É—Å–ª—É–≥–∏"}}},{"parameters":{"operation":"deleteMessage","chatId":"={{ $node[\"Webhook\"].json[\"query\"][\"telegram_id\"] }}","messageId":"={{ $node[\"Code\"].json[\"msgid\"] }}"},"id":"42b948de-05c9-4898-a308-6684103b993b","name":"—É–¥–∞–ª–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ1","type":"n8n-nodes-base.telegram","typeVersion":1,"position":[1800,120],"credentials":{"telegramApi":{"id":"33","name":"–ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å —É—Å–ª—É–≥–∏"}}},{"parameters":{"operation":"deleteMessage","chatId":"={{ $node[\"Webhook\"].json[\"query\"][\"telegram_id\"] }}","messageId":"={{ $node[\"Code\"].json[\"msgid\"] }}"},"id":"8c1568b1-01ea-46ad-95a5-c67f13fb1784","name":"—É–¥–∞–ª–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ2","type":"n8n-nodes-base.telegram","typeVersion":1,"position":[1940,840],"credentials":{"telegramApi":{"id":"33","name":"–ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å —É—Å–ª—É–≥–∏"}}},{"parameters":{"chatId":"={{ $node[\"Webhook\"].json[\"query\"][\"telegram_id\"] }}","text":"=üõ†Ô∏è –ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –≤ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç —É –í–∞—Å –Ω–µ—Ç –∑–∞—è–≤–æ–∫ –Ω–∞ —É—Å–ª—É–≥–∏ –Ω–∞—à–∏—Ö –º–∞—Å—Ç–µ—Ä–æ–≤.\n\n–û–¥–Ω–∞–∫–æ –Ω–µ –æ—Ç—á–∞–∏–≤–∞–π—Ç–µ—Å—å! üí™ –ï—Å–ª–∏ —É –≤–∞—Å –±—É–¥–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å, —Å–æ–∑–¥–∞–π—Ç–µ –∑–∞—è–≤–∫—É –∏ –Ω–∞—à–∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—ã —Å —Ä–∞–¥–æ—Å—Ç—å—é –æ–∫–∞–∂—É—Ç –≤–∞–º –ø–æ–º–æ—â—å! üí∞","replyMarkup":"inlineKeyboard","inlineKeyboard":{"rows":[{"row":{"buttons":[{"text":"üîµ –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç","additionalFields":{"callback_data":"–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç"}}]}}]},"additionalFields":{}},"id":"47dcbc26-0c51-4ff0-a9bb-e381834f5580","name":"–Ω–µ—Ç –∑–∞—è–≤–æ–∫","type":"n8n-nodes-base.telegram","typeVersion":1,"position":[780,-80],"credentials":{"telegramApi":{"id":"33","name":"–ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å —É—Å–ª—É–≥–∏"}}},{"parameters":{"chatId":"={{ $node[\"Webhook\"].json[\"query\"][\"telegram_id\"] }}","text":"=<b>–ó–∞—è–≤–∫–∞ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏</b> üëá\n\n{{ $node[\"—Ç–µ–∫—Å—Ç1\"].json[\"aggregatedText\"] }}\n","replyMarkup":"inlineKeyboard","inlineKeyboard":{"rows":[{"row":{"buttons":[{"text":"üîµ –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç","additionalFields":{"callback_data":"–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç"}}]}}]},"additionalFields":{"parse_mode":"HTML"}},"id":"50404272-539d-4793-a243-0a27721e33d2","name":"Telegram","type":"n8n-nodes-base.telegram","typeVersion":1,"position":[2100,840],"credentials":{"telegramApi":{"id":"33","name":"–ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å —É—Å–ª—É–≥–∏"}}},{"parameters":{"documentId":{"__rl":true,"value":"1_mVTlW_BvNIQ30QbtAC59sPq3-ynnggfG01WI4A0WjE","mode":"list","cachedResultName":"–ó–∞–∫–∞–∑—ã –∫–ª–∏–µ–Ω—Ç–æ–≤(–º–∞—Ä–∫–µ—Ç–ø–ª—ç–π—Å —É—Å–ª—É–≥)","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1_mVTlW_BvNIQ30QbtAC59sPq3-ynnggfG01WI4A0WjE/edit?usp=drivesdk"},"sheetName":{"__rl":true,"value":"gid=0","mode":"list","cachedResultName":"–ó–∞–∫–∞–∑—ã –∫–ª–∏–µ–Ω—Ç–æ–≤(–º–∞—Ä–∫–µ—Ç–ø–ª—ç–π—Å —É—Å–ª—É–≥)","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1_mVTlW_BvNIQ30QbtAC59sPq3-ynnggfG01WI4A0WjE/edit#gid=0"},"filtersUI":{"values":[{"lookupColumn":"–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è","lookupValue":"={{ $node[\"Code\"].json[\"klient_otvet_order\"] }}"}]},"options":{}},"id":"548bddee-ef45-4d93-8585-8e03b3a4e4e4","name":"Google Sheets2","type":"n8n-nodes-base.googleSheets","typeVersion":3,"position":[-60,1080],"credentials":{"googleSheetsOAuth2Api":{"id":"27","name":"Google Sheets account"}}},{"parameters":{"documentId":{"__rl":true,"value":"1_mVTlW_BvNIQ30QbtAC59sPq3-ynnggfG01WI4A0WjE","mode":"list","cachedResultName":"–ó–∞–∫–∞–∑—ã –∫–ª–∏–µ–Ω—Ç–æ–≤(–º–∞—Ä–∫–µ—Ç–ø–ª—ç–π—Å —É—Å–ª—É–≥)","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1_mVTlW_BvNIQ30QbtAC59sPq3-ynnggfG01WI4A0WjE/edit?usp=drivesdk"},"sheetName":{"__rl":true,"value":"gid=0","mode":"list","cachedResultName":"–ó–∞–∫–∞–∑—ã –∫–ª–∏–µ–Ω—Ç–æ–≤(–º–∞—Ä–∫–µ—Ç–ø–ª—ç–π—Å —É—Å–ª—É–≥)","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1_mVTlW_BvNIQ30QbtAC59sPq3-ynnggfG01WI4A0WjE/edit#gid=0"},"filtersUI":{"values":[{"lookupColumn":"–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è","lookupValue":"={{ $node[\"Code\"].json[\"klient_otvet_order\"] }}"}]},"options":{}},"id":"ab08e50a-eeba-4494-8945-af6b092c1cad","name":"Google Sheets3","type":"n8n-nodes-base.googleSheets","typeVersion":3,"position":[-60,1280],"credentials":{"googleSheetsOAuth2Api":{"id":"27","name":"Google Sheets account"}}},{"parameters":{"operation":"update","documentId":{"__rl":true,"value":"1_mVTlW_BvNIQ30QbtAC59sPq3-ynnggfG01WI4A0WjE","mode":"list","cachedResultName":"–ó–∞–∫–∞–∑—ã –∫–ª–∏–µ–Ω—Ç–æ–≤(–º–∞—Ä–∫–µ—Ç–ø–ª—ç–π—Å —É—Å–ª—É–≥)","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1_mVTlW_BvNIQ30QbtAC59sPq3-ynnggfG01WI4A0WjE/edit?usp=drivesdk"},"sheetName":{"__rl":true,"value":"gid=0","mode":"list","cachedResultName":"–ó–∞–∫–∞–∑—ã –∫–ª–∏–µ–Ω—Ç–æ–≤(–º–∞—Ä–∫–µ—Ç–ø–ª—ç–π—Å —É—Å–ª—É–≥)","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1_mVTlW_BvNIQ30QbtAC59sPq3-ynnggfG01WI4A0WjE/edit#gid=0"},"columnToMatchOn":"–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è","valueToMatchOn":"={{ $json[\"–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è\"] }}","fieldsUi":{"values":[{"column":"–í–æ—Ä–æ–Ω–∫–∞","fieldValue":"9. –∫–ª–∏–µ–Ω—Ç –ø—Ä–∏–Ω—è–ª —Ä–∞–±–æ—Ç—É"}]},"options":{}},"id":"a3cc46bb-06b3-44ed-8b09-5fdfaf9a4726","name":"Google Sheets4","type":"n8n-nodes-base.googleSheets","typeVersion":3,"position":[100,1080],"credentials":{"googleSheetsOAuth2Api":{"id":"27","name":"Google Sheets account"}}},{"parameters":{"documentId":{"__rl":true,"value":"1_mVTlW_BvNIQ30QbtAC59sPq3-ynnggfG01WI4A0WjE","mode":"list","cachedResultName":"–ó–∞–∫–∞–∑—ã –∫–ª–∏–µ–Ω—Ç–æ–≤(–º–∞—Ä–∫–µ—Ç–ø–ª—ç–π—Å —É—Å–ª—É–≥)","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1_mVTlW_BvNIQ30QbtAC59sPq3-ynnggfG01WI4A0WjE/edit?usp=drivesdk"},"sheetName":{"__rl":true,"value":"gid=0","mode":"list","cachedResultName":"–ó–∞–∫–∞–∑—ã –∫–ª–∏–µ–Ω—Ç–æ–≤(–º–∞—Ä–∫–µ—Ç–ø–ª—ç–π—Å —É—Å–ª—É–≥)","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1_mVTlW_BvNIQ30QbtAC59sPq3-ynnggfG01WI4A0WjE/edit#gid=0"},"filtersUI":{"values":[{"lookupColumn":"–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è","lookupValue":"={{ $node[\"Code\"].json[\"klient_otvet_order\"] }}"}]},"options":{}},"id":"31c691fa-5675-4b8d-bbea-9b89658816d7","name":"Google Sheets5","type":"n8n-nodes-base.googleSheets","typeVersion":3,"position":[260,1080],"credentials":{"googleSheetsOAuth2Api":{"id":"27","name":"Google Sheets account"}}},{"parameters":{"operation":"deleteMessage","chatId":"={{ $node[\"Webhook\"].json[\"query\"][\"telegram_id\"] }}","messageId":"={{ $node[\"Code\"].json[\"msgid\"] }}"},"id":"6b0ef922-c330-412c-9007-09d90d9132c3","name":"—É–¥–∞–ª–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ3","type":"n8n-nodes-base.telegram","typeVersion":1,"position":[580,1080],"credentials":{"telegramApi":{"id":"33","name":"–ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å —É—Å–ª—É–≥–∏"}}},{"parameters":{"chatId":"={{ $node[\"Webhook\"].json[\"query\"][\"telegram_id\"] }}","text":"=<b>–°—Ç–∞—Ç—É—Å –∑–∞—è–≤–∫–∏ –∏–∑–º–µ–Ω–∏–ª—Å—è</b> üëá\n\n{{ $node[\"Code1\"].json[\"aggregatedText\"] }}\n\n\n–ú—ã –æ—á–µ–Ω—å —Ä–∞–¥—ã, —á—Ç–æ –Ω–∞—à —Å–µ—Ä–≤–∏—Å –±—ã–ª –≤–∞–º –ø–æ–ª–µ–∑–µ–Ω! üí∞üí∏üí∞ –ú—ã —Ü–µ–Ω–∏–º –≤–∞—à—É –ª–æ—è–ª—å–Ω–æ—Å—Ç—å –∏ –Ω–∞–¥–µ–µ–º—Å—è –Ω–∞ –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –Ω–∞—à–µ–≥–æ –ø–ª–æ–¥–æ—Ç–≤–æ—Ä–Ω–æ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–∞. ü§ù –° —É–≤–∞–∂–µ–Ω–∏–µ–º, –∞–¥–º–∏–Ω–∏—Å—Ç–∞—Ä–∞—Ü–∏—è ","replyMarkup":"inlineKeyboard","inlineKeyboard":{"rows":[{"row":{"buttons":[{"text":"üîµ –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç","additionalFields":{"callback_data":"–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç"}}]}}]},"additionalFields":{"parse_mode":"HTML"}},"id":"8c7ef70a-8e3d-4c37-a6ee-3e11ad2ac3f3","name":"Telegram1","type":"n8n-nodes-base.telegram","typeVersion":1,"position":[740,1080],"credentials":{"telegramApi":{"id":"33","name":"–ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å —É—Å–ª—É–≥–∏"}}},{"parameters":{"operation":"update","documentId":{"__rl":true,"value":"1_mVTlW_BvNIQ30QbtAC59sPq3-ynnggfG01WI4A0WjE","mode":"list","cachedResultName":"–ó–∞–∫–∞–∑—ã –∫–ª–∏–µ–Ω—Ç–æ–≤(–º–∞—Ä–∫–µ—Ç–ø–ª—ç–π—Å —É—Å–ª—É–≥)","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1_mVTlW_BvNIQ30QbtAC59sPq3-ynnggfG01WI4A0WjE/edit?usp=drivesdk"},"sheetName":{"__rl":true,"value":"gid=0","mode":"list","cachedResultName":"–ó–∞–∫–∞–∑—ã –∫–ª–∏–µ–Ω—Ç–æ–≤(–º–∞—Ä–∫–µ—Ç–ø–ª—ç–π—Å —É—Å–ª—É–≥)","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1_mVTlW_BvNIQ30QbtAC59sPq3-ynnggfG01WI4A0WjE/edit#gid=0"},"columnToMatchOn":"–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è","valueToMatchOn":"={{ $json[\"–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è\"] }}","fieldsUi":{"values":[{"column":"–í–æ—Ä–æ–Ω–∫–∞","fieldValue":"10. –∫–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–∏–ª –Ω–∞ –¥–æ—Ä–∞–±–æ—Ç–∫—É"}]},"options":{}},"id":"04b03d9d-0896-46e7-98ad-90119bb2a1d5","name":"Google Sheets6","type":"n8n-nodes-base.googleSheets","typeVersion":3,"position":[100,1280],"credentials":{"googleSheetsOAuth2Api":{"id":"27","name":"Google Sheets account"}}},{"parameters":{"documentId":{"__rl":true,"value":"1_mVTlW_BvNIQ30QbtAC59sPq3-ynnggfG01WI4A0WjE","mode":"list","cachedResultName":"–ó–∞–∫–∞–∑—ã –∫–ª–∏–µ–Ω—Ç–æ–≤(–º–∞—Ä–∫–µ—Ç–ø–ª—ç–π—Å —É—Å–ª—É–≥)","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1_mVTlW_BvNIQ30QbtAC59sPq3-ynnggfG01WI4A0WjE/edit?usp=drivesdk"},"sheetName":{"__rl":true,"value":"gid=0","mode":"list","cachedResultName":"–ó–∞–∫–∞–∑—ã –∫–ª–∏–µ–Ω—Ç–æ–≤(–º–∞—Ä–∫–µ—Ç–ø–ª—ç–π—Å —É—Å–ª—É–≥)","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1_mVTlW_BvNIQ30QbtAC59sPq3-ynnggfG01WI4A0WjE/edit#gid=0"},"filtersUI":{"values":[{"lookupColumn":"–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è","lookupValue":"={{ $node[\"Code\"].json[\"klient_otvet_order\"] }}"}]},"options":{}},"id":"e6699780-5726-4039-af70-8c66d5bea285","name":"Google Sheets7","type":"n8n-nodes-base.googleSheets","typeVersion":3,"position":[260,1280],"credentials":{"googleSheetsOAuth2Api":{"id":"27","name":"Google Sheets account"}}},{"parameters":{"operation":"deleteMessage","chatId":"={{ $node[\"Webhook\"].json[\"query\"][\"telegram_id\"] }}","messageId":"={{ $node[\"Code\"].json[\"msgid\"] }}"},"id":"cd58a7ce-6083-4d2e-b68d-77b247748583","name":"—É–¥–∞–ª–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ4","type":"n8n-nodes-base.telegram","typeVersion":1,"position":[580,1280],"credentials":{"telegramApi":{"id":"33","name":"–ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å —É—Å–ª—É–≥–∏"}}},{"parameters":{"chatId":"={{ $node[\"Webhook\"].json[\"query\"][\"telegram_id\"] }}","text":"=<b>–°—Ç–∞—Ç—É—Å –∑–∞—è–≤–∫–∏ –∏–∑–º–µ–Ω–∏–ª—Å—è</b> üëá\n\n{{ $node[\"Code2\"].json[\"aggregatedText\"] }}\n\n","replyMarkup":"inlineKeyboard","inlineKeyboard":{"rows":[{"row":{"buttons":[{"text":"üîµ –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç","additionalFields":{"callback_data":"–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç"}}]}}]},"additionalFields":{"parse_mode":"HTML"}},"id":"bc6a74e0-1eb9-4252-8d34-464b1e90a91d","name":"Telegram2","type":"n8n-nodes-base.telegram","typeVersion":1,"position":[740,1280],"credentials":{"telegramApi":{"id":"33","name":"–ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å —É—Å–ª—É–≥–∏"}}},{"parameters":{"jsCode":"let aggregatedText = '';\n\nitems.forEach(item => {\n  const rowNumber = item.json.row_number;\n  let funnel = item.json['–í–æ—Ä–æ–Ω–∫–∞'];\n\n  funnel = funnel.slice(funnel.indexOf('.') + 2); // —É–¥–∞–ª—è–µ–º —á–∏—Å–ª–æ –∏ —Ç–æ—á–∫—É\n\n  aggregatedText += `üëå <b>–ó–∞—è–≤–∫–∞ ‚Ññ${rowNumber}</b>`;\n  aggregatedText += `\\n<i>–°—Ç–∞—Ç—É—Å –∑–∞—è–≤–∫–∏ –∏–∑–º–µ–Ω–∏–ª—Å—è –Ω–∞ ${funnel}</i> ‚úç\\n\\n`;\n});\n\nreturn [{json: {aggregatedText}}];"},"id":"f3fead06-0619-439c-8bd9-4e2a60a3ae69","name":"Code1","type":"n8n-nodes-base.code","typeVersion":1,"position":[420,1080]},{"parameters":{"jsCode":"let aggregatedText = '';\n\nitems.forEach(item => {\n  const rowNumber = item.json.row_number;\n  let funnel = item.json['–í–æ—Ä–æ–Ω–∫–∞'];\n\n  funnel = funnel.slice(funnel.indexOf('.') + 2); // —É–¥–∞–ª—è–µ–º —á–∏—Å–ª–æ –∏ —Ç–æ—á–∫—É\n\n  aggregatedText += `üëå <b>–ó–∞—è–≤–∫–∞ ‚Ññ${rowNumber}</b>`;\n  aggregatedText += `\\n<i>–°—Ç–∞—Ç—É—Å –∑–∞—è–≤–∫–∏ –∏–∑–º–µ–Ω–∏–ª—Å—è –Ω–∞ ${funnel}</i> ‚úç\\n\\n`;\n});\n\nreturn [{json: {aggregatedText}}];"},"id":"5131f3f7-dc56-477d-b616-8855190c6056","name":"Code2","type":"n8n-nodes-base.code","typeVersion":1,"position":[420,1280]},{"parameters":{"jsCode":"function getStatus(funnel) {\n  switch (funnel.split('.')[0]) {\n    case '4': return 'üìù –ú–∞—Å—Ç–µ—Ä –Ω–∞–∑–Ω–∞—á–µ–Ω';\n    case '5': return 'üö∂ 1—ã–π –≤–∏–∑–∏—Ç –º–∞—Å—Ç–µ—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω';\n    case '6': return 'üí≥ –¶–µ–Ω–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∞ –Ω–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç—É';\n    case '7': return '‚úÖ –ö–ª–∏–µ–Ω—Ç –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª';\n    case '10': return 'ü™õ –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–∏–ª –Ω–∞ –¥–æ—Ä–∞–±–æ—Ç–∫—É';\n    default: return funnel;\n  }\n}\n\nlet aggregatedText = '';\nitems.forEach(item => {\n  const rowNumber = item.json.row_number;\n  const specialist = item.json['–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç'];\n  const description = item.json['–û–ø–∏—Å–∞–Ω–∏–µ —Ä–∞–±–æ—Ç'];\n  const executionDate = item.json['–î–∞—Ç–∞ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è'];\n  const executionTime = item.json['–í—Ä–µ–º—è –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è'];\n  let funnel = item.json['–í–æ—Ä–æ–Ω–∫–∞'];\n  const masterAppointed = item.json['–ú–∞—Å—Ç–µ—Ä –Ω–∞–∑–Ω–∞—á–µ–Ω'];\n  const cost = item.json['–°—Ç–æ–∏–º–æ—Å—Ç—å —Ä–∞–±–æ—Ç'] || '-';\n  const additionalMaterials = item.json['–î–æ–ø. –º–∞—Ç–µ—Ä–∏–∞–ª—ã'] || '-';\n  const comment = item.json['–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π'] || '-';\n  const photo = item.json['–§–æ—Ç–æ'] || '-';\n\n  if (funnel.startsWith('4.')) {\n    funnel = 'üìù –ú–∞—Å—Ç–µ—Ä –Ω–∞–∑–Ω–∞—á–µ–Ω';\n  } else if (funnel.startsWith('5.')) {\n    funnel = 'üö∂ 1—ã–π –≤–∏–∑–∏—Ç –º–∞—Å—Ç–µ—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω';\n  } else if (funnel.startsWith('6.')) {\n    funnel = 'üí≥ –¶–µ–Ω–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∞ –Ω–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç—É';\n  } else if (funnel.startsWith('7.')) {\n    funnel = '‚úÖ –ö–ª–∏–µ–Ω—Ç –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª';\n  } else if (funnel.startsWith('10.')) {\n    funnel = 'ü™õ –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–∏–ª –Ω–∞ –¥–æ—Ä–∞–±–æ—Ç–∫—É';\n  }\n  \n  aggregatedText += `‚û§ <b>–ó–∞—è–≤–∫–∞ ‚Ññ${rowNumber}</b>\\n\\n`;\n  aggregatedText += `‚Ä¢ üë§ <b>–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–π —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç:</b> <i>${specialist}</i>\\n`;\n  aggregatedText += `‚Ä¢ üìÉ <b>–û–ø–∏—Å–∞–Ω–∏–µ —Ä–∞–±–æ—Ç:</b> <i>${description}</i>\\n`;\n  aggregatedText += `‚Ä¢ üìÖ <b>–î–∞—Ç–∞ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è:</b> <i>${executionDate}</i>\\n`;\n  aggregatedText += `‚Ä¢ üï∞ <b>–í—Ä–µ–º—è –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è:</b> <i>${executionTime}</i>\\n`;\n  aggregatedText += `‚Ä¢ üõ† <b>–°—Ç–∞—Ç—É—Å –∑–∞—è–≤–∫–∏:</b> <i>${getStatus(funnel)}</i>\\n`;\n  aggregatedText += `‚Ä¢ üí∞ <b>–°—Ç–æ–∏–º–æ—Å—Ç—å —Ä–∞–±–æ—Ç:</b> <i>${cost}</i> ‚ÇΩ\\n`;\n  aggregatedText += `‚Ä¢ üóÉ <b>–î–æ–ø. –º–∞—Ç–µ—Ä–∏–∞–ª—ã:</b> <i>${additionalMaterials}</i>\\n`;\n  aggregatedText += `‚Ä¢ üí¨ <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:</b> <i>${comment}</i>\\n`;\n  aggregatedText += `‚Ä¢ üì∑ <b>–§–æ—Ç–æ:</b> <i>${photo}</i>\\n`;\n  \n  if (masterAppointed) {\n    aggregatedText += `‚Ä¢ üß∞ <b>–ú–∞—Å—Ç–µ—Ä –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å:</b><i> üëã ${masterAppointed}</i>\\n`;\n  }\n\n  aggregatedText += '\\n';\n});\n\nreturn [{ json: { aggregatedText } }];"},"id":"ff779090-72ed-46b5-bc19-09b181b0c430","name":"—Ç–µ–∫—Å—Ç2","type":"n8n-nodes-base.code","typeVersion":1,"position":[1180,440]},{"parameters":{"conditions":{"string":[{"value1":"={{ $json[\"–í–æ—Ä–æ–Ω–∫–∞\"] }}","value2":"6. —Ü–µ–Ω–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∞ –Ω–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç—É"}]}},"id":"c2ead129-c536-4899-8c9a-5f00dbbcb6ef","name":"IF2","type":"n8n-nodes-base.if","typeVersion":1,"position":[940,460]},{"parameters":{"operation":"deleteMessage","chatId":"={{ $node[\"Webhook\"].json[\"query\"][\"telegram_id\"] }}","messageId":"={{ $node[\"Code\"].json[\"msgid\"] }}"},"id":"301b6723-7c0d-4c31-a00f-c3407ca80e18","name":"—É–¥–∞–ª–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ5","type":"n8n-nodes-base.telegram","typeVersion":1,"position":[1320,440],"credentials":{"telegramApi":{"id":"33","name":"–ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å —É—Å–ª—É–≥–∏"}}},{"parameters":{"chatId":"={{ $node[\"Webhook\"].json[\"query\"][\"telegram_id\"] }}","text":"=<b>–ó–∞—è–≤–∫–∞ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏</b> üëá\n\n{{ $node[\"—Ç–µ–∫—Å—Ç2\"].json[\"aggregatedText\"] }}\n\nüëâ‚úî –ù–∞–∂–º–∏—Ç–µ \"–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å\", —á—Ç–æ–±—ã –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∑–∞—è–≤–∫—É\n\nüëâ‚ùå –ù–∞–∂–º–∏—Ç–µ \"–û—Ç–∫–∞–∑–∞—Ç—å—Å—è\", –µ—Å–ª–∏ —É—Å–ª–æ–≤–∏—è –í–∞—Å –Ω–µ —É—Å—Ä–∞–∏–≤–∞—é—Ç.\n","replyMarkup":"inlineKeyboard","inlineKeyboard":{"rows":[{"row":{"buttons":[{"text":"‚úî –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å","additionalFields":{"callback_data":"–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å"}}]}},{"row":{"buttons":[{"text":"‚ùå –û—Ç–∫–∞–∑–∞—Ç—å—Å—è","additionalFields":{"callback_data":"–û—Ç–∫–∞–∑–∞—Ç—å—Å—è"}}]}},{},{"row":{"buttons":[{"text":"üîµ –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç","additionalFields":{"callback_data":"–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç"}}]}}]},"additionalFields":{"parse_mode":"HTML"}},"id":"d746b1fc-829c-4eda-89b7-f6c087fdc6bc","name":"Telegram3","type":"n8n-nodes-base.telegram","typeVersion":1,"position":[1460,440],"credentials":{"telegramApi":{"id":"33","name":"–ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å —É—Å–ª—É–≥–∏"}}},{"parameters":{"conditions":{"string":[{"value1":"={{ $json[\"x\"] }}","value2":"4"}]}},"id":"1517b383-0a09-4c60-ba07-8da1effae970","name":"IF3","type":"n8n-nodes-base.if","typeVersion":1,"position":[-240,1360]},{"parameters":{"documentId":{"__rl":true,"value":"1_mVTlW_BvNIQ30QbtAC59sPq3-ynnggfG01WI4A0WjE","mode":"list","cachedResultName":"–ó–∞–∫–∞–∑—ã –∫–ª–∏–µ–Ω—Ç–æ–≤(–º–∞—Ä–∫–µ—Ç–ø–ª—ç–π—Å —É—Å–ª—É–≥)","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1_mVTlW_BvNIQ30QbtAC59sPq3-ynnggfG01WI4A0WjE/edit?usp=drivesdk"},"sheetName":{"__rl":true,"value":"gid=0","mode":"list","cachedResultName":"–ó–∞–∫–∞–∑—ã –∫–ª–∏–µ–Ω—Ç–æ–≤(–º–∞—Ä–∫–µ—Ç–ø–ª—ç–π—Å —É—Å–ª—É–≥)","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1_mVTlW_BvNIQ30QbtAC59sPq3-ynnggfG01WI4A0WjE/edit#gid=0"},"filtersUI":{"values":[{"lookupColumn":"–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è","lookupValue":"={{ $node[\"Code\"].json[\"klient_otvet_order\"] }}"}]},"options":{}},"id":"43173e64-b1dc-4af3-81f1-16b6c888c7c5","name":"Google Sheets8","type":"n8n-nodes-base.googleSheets","typeVersion":3,"position":[-60,1480],"credentials":{"googleSheetsOAuth2Api":{"id":"27","name":"Google Sheets account"}}},{"parameters":{"operation":"update","documentId":{"__rl":true,"value":"1_mVTlW_BvNIQ30QbtAC59sPq3-ynnggfG01WI4A0WjE","mode":"list","cachedResultName":"–ó–∞–∫–∞–∑—ã –∫–ª–∏–µ–Ω—Ç–æ–≤(–º–∞—Ä–∫–µ—Ç–ø–ª—ç–π—Å —É—Å–ª—É–≥)","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1_mVTlW_BvNIQ30QbtAC59sPq3-ynnggfG01WI4A0WjE/edit?usp=drivesdk"},"sheetName":{"__rl":true,"value":"gid=0","mode":"list","cachedResultName":"–ó–∞–∫–∞–∑—ã –∫–ª–∏–µ–Ω—Ç–æ–≤(–º–∞—Ä–∫–µ—Ç–ø–ª—ç–π—Å —É—Å–ª—É–≥)","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1_mVTlW_BvNIQ30QbtAC59sPq3-ynnggfG01WI4A0WjE/edit#gid=0"},"columnToMatchOn":"–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è","valueToMatchOn":"={{ $json[\"–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è\"] }}","fieldsUi":{"values":[{"column":"–í–æ—Ä–æ–Ω–∫–∞","fieldValue":"7. –∫–ª–∏–µ–Ω—Ç –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª"}]},"options":{}},"id":"5fda9749-1068-4ede-ac9b-48514bf5aed1","name":"Google Sheets9","type":"n8n-nodes-base.googleSheets","typeVersion":3,"position":[100,1480],"credentials":{"googleSheetsOAuth2Api":{"id":"27","name":"Google Sheets account"}}},{"parameters":{"documentId":{"__rl":true,"value":"1_mVTlW_BvNIQ30QbtAC59sPq3-ynnggfG01WI4A0WjE","mode":"list","cachedResultName":"–ó–∞–∫–∞–∑—ã –∫–ª–∏–µ–Ω—Ç–æ–≤(–º–∞—Ä–∫–µ—Ç–ø–ª—ç–π—Å —É—Å–ª—É–≥)","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1_mVTlW_BvNIQ30QbtAC59sPq3-ynnggfG01WI4A0WjE/edit?usp=drivesdk"},"sheetName":{"__rl":true,"value":"gid=0","mode":"list","cachedResultName":"–ó–∞–∫–∞–∑—ã –∫–ª–∏–µ–Ω—Ç–æ–≤(–º–∞—Ä–∫–µ—Ç–ø–ª—ç–π—Å —É—Å–ª—É–≥)","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1_mVTlW_BvNIQ30QbtAC59sPq3-ynnggfG01WI4A0WjE/edit#gid=0"},"filtersUI":{"values":[{"lookupColumn":"–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è","lookupValue":"={{ $node[\"Code\"].json[\"klient_otvet_order\"] }}"}]},"options":{}},"id":"e013baa7-b42e-4a78-b951-a56bdeb49bad","name":"Google Sheets10","type":"n8n-nodes-base.googleSheets","typeVersion":3,"position":[260,1480],"credentials":{"googleSheetsOAuth2Api":{"id":"27","name":"Google Sheets account"}}},{"parameters":{"jsCode":"function getStatus(funnel) {\n  switch (funnel.split('.')[0]) {\n    case '4': return 'üìù –ú–∞—Å—Ç–µ—Ä –Ω–∞–∑–Ω–∞—á–µ–Ω';\n    case '5': return 'üö∂ 1—ã–π –≤–∏–∑–∏—Ç –º–∞—Å—Ç–µ—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω';\n    case '6': return 'üí≥ –¶–µ–Ω–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∞ –Ω–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç—É';\n    case '7': return '‚úÖ –ö–ª–∏–µ–Ω—Ç –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª';\n    case '10': return 'ü™õ –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–∏–ª –Ω–∞ –¥–æ—Ä–∞–±–æ—Ç–∫—É';\n    default: return funnel;\n  }\n}\n\nlet aggregatedText = '';\nitems.forEach(item => {\n  const rowNumber = item.json.row_number;\n  const specialist = item.json['–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç'];\n  const description = item.json['–û–ø–∏—Å–∞–Ω–∏–µ —Ä–∞–±–æ—Ç'];\n  const executionDate = item.json['–î–∞—Ç–∞ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è'];\n  const executionTime = item.json['–í—Ä–µ–º—è –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è'];\n  let funnel = item.json['–í–æ—Ä–æ–Ω–∫–∞'];\n  const masterAppointed = item.json['–ú–∞—Å—Ç–µ—Ä –Ω–∞–∑–Ω–∞—á–µ–Ω'];\n  const cost = item.json['–°—Ç–æ–∏–º–æ—Å—Ç—å —Ä–∞–±–æ—Ç'] || '-';\n  const additionalMaterials = item.json['–î–æ–ø. –º–∞—Ç–µ—Ä–∏–∞–ª—ã'] || '-';\n  const comment = item.json['–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π'] || '-';\n  const photo = item.json['–§–æ—Ç–æ'] || '-';\n\n  if (funnel.startsWith('4.')) {\n    funnel = 'üìù –ú–∞—Å—Ç–µ—Ä –Ω–∞–∑–Ω–∞—á–µ–Ω';\n  } else if (funnel.startsWith('5.')) {\n    funnel = 'üö∂ 1—ã–π –≤–∏–∑–∏—Ç –º–∞—Å—Ç–µ—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω';\n  } else if (funnel.startsWith('6.')) {\n    funnel = 'üí≥ –¶–µ–Ω–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∞ –Ω–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç—É';\n  } else if (funnel.startsWith('7.')) {\n    funnel = '‚úÖ –ö–ª–∏–µ–Ω—Ç –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª';\n  } else if (funnel.startsWith('10.')) {\n    funnel = 'ü™õ –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–∏–ª –Ω–∞ –¥–æ—Ä–∞–±–æ—Ç–∫—É';\n  }\n  \n  aggregatedText += `‚û§ <b>–ó–∞—è–≤–∫–∞ ‚Ññ${rowNumber}</b>\\n\\n`;\n  aggregatedText += `‚Ä¢ üë§ <b>–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–π —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç:</b> <i>${specialist}</i>\\n`;\n  aggregatedText += `‚Ä¢ üìÉ <b>–û–ø–∏—Å–∞–Ω–∏–µ —Ä–∞–±–æ—Ç:</b> <i>${description}</i>\\n`;\n  aggregatedText += `‚Ä¢ üìÖ <b>–î–∞—Ç–∞ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è:</b> <i>${executionDate}</i>\\n`;\n  aggregatedText += `‚Ä¢ üï∞ <b>–í—Ä–µ–º—è –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è:</b> <i>${executionTime}</i>\\n`;\n  aggregatedText += `‚Ä¢ üõ† <b>–°—Ç–∞—Ç—É—Å –∑–∞—è–≤–∫–∏:</b> <i>${getStatus(funnel)}</i>\\n`;\n  aggregatedText += `‚Ä¢ üí∞ <b>–°—Ç–æ–∏–º–æ—Å—Ç—å —Ä–∞–±–æ—Ç:</b> <i>${cost}</i> ‚ÇΩ\\n`;\n  aggregatedText += `‚Ä¢ üóÉ <b>–î–æ–ø. –º–∞—Ç–µ—Ä–∏–∞–ª—ã:</b> <i>${additionalMaterials}</i>\\n`;\n  aggregatedText += `‚Ä¢ üí¨ <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:</b> <i>${comment}</i>\\n`;\n  aggregatedText += `‚Ä¢ üì∑ <b>–§–æ—Ç–æ:</b> <i>${photo}</i>\\n`;\n  \n  if (masterAppointed) {\n    aggregatedText += `‚Ä¢ üß∞ <b>–ú–∞—Å—Ç–µ—Ä –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å:</b><i> üëã ${masterAppointed}</i>\\n`;\n  }\n\n  aggregatedText += '\\n';\n});\n\nreturn [{ json: { aggregatedText } }];"},"id":"e80f1719-4f1d-495f-98a7-b0f6fac60376","name":"—Ç–µ–∫—Å—Ç3","type":"n8n-nodes-base.code","typeVersion":1,"position":[420,1480]},{"parameters":{"operation":"deleteMessage","chatId":"={{ $node[\"Webhook\"].json[\"query\"][\"telegram_id\"] }}","messageId":"={{ $node[\"Code\"].json[\"msgid\"] }}"},"id":"c783ca10-a779-461b-a613-b2600786ff69","name":"—É–¥–∞–ª–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ6","type":"n8n-nodes-base.telegram","typeVersion":1,"position":[580,1480],"credentials":{"telegramApi":{"id":"33","name":"–ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å —É—Å–ª—É–≥–∏"}}},{"parameters":{"chatId":"={{ $node[\"Webhook\"].json[\"query\"][\"telegram_id\"] }}","text":"=<b>–°—Ç–∞—Ç—É—Å –∑–∞—è–≤–∫–∏ –∏–∑–º–µ–Ω–∏–ª—Å—è</b> üëá\n\n{{ $node[\"—Ç–µ–∫—Å—Ç3\"].json[\"aggregatedText\"] }}\n\n","replyMarkup":"inlineKeyboard","inlineKeyboard":{"rows":[{"row":{"buttons":[{"text":"üîµ –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç","additionalFields":{"callback_data":"–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç"}}]}}]},"additionalFields":{"parse_mode":"HTML"}},"id":"0cb0cdd6-86b8-4638-a738-87cebde295de","name":"Telegram4","type":"n8n-nodes-base.telegram","typeVersion":1,"position":[740,1480],"credentials":{"telegramApi":{"id":"33","name":"–ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å —É—Å–ª—É–≥–∏"}}},{"parameters":{"dataType":"string","value1":"={{ $json[\"–í–æ—Ä–æ–Ω–∫–∞\"] }}","rules":{"rules":[{"value2":"7. –∫–ª–∏–µ–Ω—Ç –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª"},{"value2":"10. –∫–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–∏–ª –Ω–∞ –¥–æ—Ä–∞–±–æ—Ç–∫—É","output":1},{"value2":"4. –º–∞—Å—Ç–µ—Ä –Ω–∞–∑–Ω–∞—á–µ–Ω","output":2},{"value2":"3. –∑–∞—è–≤–∫–∞ –ø–µ—Ä–µ–¥–∞–Ω–∞ –º–∞—Å—Ç–µ—Ä–∞–º","output":2},{"value2":"5. 1—ã–π –≤–∏–∑–∏—Ç –º–∞—Å—Ç–µ—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω","output":3}]}},"id":"99f3d765-7d84-42ea-b1c1-f0fa24e4a7da","name":"Switch1","type":"n8n-nodes-base.switch","typeVersion":1,"position":[1340,620]},{"parameters":{"jsCode":"function getStatus(funnel) {\n  switch (funnel.split('.')[0]) {\n    case '4': return 'üìù –ú–∞—Å—Ç–µ—Ä –Ω–∞–∑–Ω–∞—á–µ–Ω';\n    case '5': return 'üö∂ 1—ã–π –≤–∏–∑–∏—Ç –º–∞—Å—Ç–µ—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω';\n    case '6': return 'üí≥ –¶–µ–Ω–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∞ –Ω–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç—É';\n    case '7': return '‚úÖ –ö–ª–∏–µ–Ω—Ç –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª';\n    case '10': return 'ü™õ –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–∏–ª –Ω–∞ –¥–æ—Ä–∞–±–æ—Ç–∫—É';\n    default: return funnel;\n  }\n}\n\nlet aggregatedText = '';\nitems.forEach(item => {\n  const rowNumber = item.json.row_number;\n  const specialist = item.json['–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç'];\n  const description = item.json['–û–ø–∏—Å–∞–Ω–∏–µ —Ä–∞–±–æ—Ç'];\n  const executionDate = item.json['–î–∞—Ç–∞ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è'];\n  const executionTime = item.json['–í—Ä–µ–º—è –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è'];\n  let funnel = item.json['–í–æ—Ä–æ–Ω–∫–∞'];\n  const masterAppointed = item.json['–ú–∞—Å—Ç–µ—Ä –Ω–∞–∑–Ω–∞—á–µ–Ω'];\n  const cost = item.json['–°—Ç–æ–∏–º–æ—Å—Ç—å —Ä–∞–±–æ—Ç'] || '-';\n  const additionalMaterials = item.json['–î–æ–ø. –º–∞—Ç–µ—Ä–∏–∞–ª—ã'] || '-';\n  const comment = item.json['–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π'] || '-';\n  const photo = item.json['–§–æ—Ç–æ'] || '-';\n\n  if (funnel.startsWith('4.')) {\n    funnel = 'üìù –ú–∞—Å—Ç–µ—Ä –Ω–∞–∑–Ω–∞—á–µ–Ω';\n  } else if (funnel.startsWith('5.')) {\n    funnel = 'üö∂ 1—ã–π –≤–∏–∑–∏—Ç –º–∞—Å—Ç–µ—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω';\n  } else if (funnel.startsWith('6.')) {\n    funnel = 'üí≥ –¶–µ–Ω–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∞ –Ω–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç—É';\n  } else if (funnel.startsWith('7.')) {\n    funnel = '‚úÖ –ö–ª–∏–µ–Ω—Ç –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª';\n  } else if (funnel.startsWith('10.')) {\n    funnel = 'ü™õ –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–∏–ª –Ω–∞ –¥–æ—Ä–∞–±–æ—Ç–∫—É';\n  }\n  \n  aggregatedText += `‚û§ <b>–ó–∞—è–≤–∫–∞ ‚Ññ${rowNumber}</b>\\n\\n`;\n  aggregatedText += `‚Ä¢ üë§ <b>–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–π —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç:</b> <i>${specialist}</i>\\n`;\n  aggregatedText += `‚Ä¢ üìÉ <b>–û–ø–∏—Å–∞–Ω–∏–µ —Ä–∞–±–æ—Ç:</b> <i>${description}</i>\\n`;\n  aggregatedText += `‚Ä¢ üìÖ <b>–î–∞—Ç–∞ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è:</b> <i>${executionDate}</i>\\n`;\n  aggregatedText += `‚Ä¢ üï∞ <b>–í—Ä–µ–º—è –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è:</b> <i>${executionTime}</i>\\n`;\n  aggregatedText += `‚Ä¢ üõ† <b>–°—Ç–∞—Ç—É—Å –∑–∞—è–≤–∫–∏:</b> <i>${getStatus(funnel)}</i>\\n`;\n  aggregatedText += `‚Ä¢ üí∞ <b>–°—Ç–æ–∏–º–æ—Å—Ç—å —Ä–∞–±–æ—Ç:</b> <i>${cost} ‚ÇΩ</i>\\n`;\n  aggregatedText += `‚Ä¢ üóÉ <b>–î–æ–ø. –º–∞—Ç–µ—Ä–∏–∞–ª—ã:</b> <i>${additionalMaterials}</i>\\n`;\n  aggregatedText += `‚Ä¢ üí¨ <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:</b> <i>${comment}</i>\\n`;\n  aggregatedText += `‚Ä¢ üì∑ <b>–§–æ—Ç–æ:</b> <i>${photo}</i>\\n`;\n  \n  if (masterAppointed) {\n    aggregatedText += `‚Ä¢ üß∞ <b>–ú–∞—Å—Ç–µ—Ä –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å:</b><i> üëã ${masterAppointed}</i>\\n`;\n  }\n\n  aggregatedText += '\\n';\n});\n\nreturn [{ json: { aggregatedText } }];"},"id":"82afb5f5-684c-4193-83ea-5c3fb8920506","name":"—Ç–µ–∫—Å—Ç4","type":"n8n-nodes-base.code","typeVersion":1,"position":[1780,440]},{"parameters":{"operation":"deleteMessage","chatId":"={{ $node[\"Webhook\"].json[\"query\"][\"telegram_id\"] }}","messageId":"={{ $node[\"Code\"].json[\"msgid\"] }}"},"id":"aaa0922f-03a0-4ab7-9dad-4e106efb965c","name":"—É–¥–∞–ª–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ7","type":"n8n-nodes-base.telegram","typeVersion":1,"position":[1940,440],"credentials":{"telegramApi":{"id":"33","name":"–ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å —É—Å–ª—É–≥–∏"}}},{"parameters":{"chatId":"={{ $node[\"Webhook\"].json[\"query\"][\"telegram_id\"] }}","text":"=<b>–ó–∞—è–≤–∫–∞ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏</b> üëá\n\n{{ $node[\"—Ç–µ–∫—Å—Ç4\"].json[\"aggregatedText\"] }}\n\n\nüëâ‚úÖ –ù–∞–∂–º–∏—Ç–µ \"–í—ã–ø–æ–ª–Ω–µ–Ω–æ\", —á—Ç–æ–±—ã –ø—Ä–∏–Ω—è—Ç—å —Ä–∞–±–æ—Ç—É.\n\nüëâ‚ûï –ï—Å–ª–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–æ–¥–µ–ª–∞—Ç—å —Ä–∞–±–æ—Ç—É, –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É \"–î–æ–¥–µ–ª–∞—Ç—å —Ä–∞–±–æ—Ç—É\"","replyMarkup":"inlineKeyboard","inlineKeyboard":{"rows":[{"row":{"buttons":[{"text":"‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ","additionalFields":{"callback_data":"–í—ã–ø–æ–ª–Ω–µ–Ω–æ"}}]}},{"row":{"buttons":[{"text":"‚ûï –î–æ–¥–µ–ª–∞—Ç—å —Ä–∞–±–æ—Ç—É","additionalFields":{"callback_data":"–î–æ–¥–µ–ª–∞—Ç—å —Ä–∞–±–æ—Ç—É"}}]}},{"row":{"buttons":[{"text":"üîµ –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç","additionalFields":{"callback_data":"–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç"}}]}}]},"additionalFields":{"parse_mode":"HTML"}},"id":"a3ba622e-ac36-4a19-a36b-ce8c0f847ec3","name":"Telegram5","type":"n8n-nodes-base.telegram","typeVersion":1,"position":[2100,440],"credentials":{"telegramApi":{"id":"33","name":"–ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å —É—Å–ª—É–≥–∏"}}},{"parameters":{"jsCode":"function getStatus(funnel) {\n  switch (funnel.split('.')[0]) {\n    case '4': return 'üìù –ú–∞—Å—Ç–µ—Ä –Ω–∞–∑–Ω–∞—á–µ–Ω';\n    case '5': return 'üö∂ 1—ã–π –≤–∏–∑–∏—Ç –º–∞—Å—Ç–µ—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω';\n    case '6': return 'üí≥ –¶–µ–Ω–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∞ –Ω–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç—É';\n    case '7': return '‚úÖ –ö–ª–∏–µ–Ω—Ç –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª';\n    case '10': return 'ü™õ –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–∏–ª –Ω–∞ –¥–æ—Ä–∞–±–æ—Ç–∫—É';\n    default: return funnel;\n  }\n}\n\nlet aggregatedText = '';\nitems.forEach(item => {\n  const rowNumber = item.json.row_number;\n  const specialist = item.json['–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç'];\n  const description = item.json['–û–ø–∏—Å–∞–Ω–∏–µ —Ä–∞–±–æ—Ç'];\n  const executionDate = item.json['–î–∞—Ç–∞ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è'];\n  const executionTime = item.json['–í—Ä–µ–º—è –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è'];\n  let funnel = item.json['–í–æ—Ä–æ–Ω–∫–∞'];\n  const masterAppointed = item.json['–ú–∞—Å—Ç–µ—Ä –Ω–∞–∑–Ω–∞—á–µ–Ω'];\n  const cost = item.json['–°—Ç–æ–∏–º–æ—Å—Ç—å —Ä–∞–±–æ—Ç'] || '-';\n  const additionalMaterials = item.json['–î–æ–ø. –º–∞—Ç–µ—Ä–∏–∞–ª—ã'] || '-';\n  const comment = item.json['–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π'] || '-';\n  const photo = item.json['–§–æ—Ç–æ'] || '-';\n\n  if (funnel.startsWith('4.')) {\n    funnel = 'üìù –ú–∞—Å—Ç–µ—Ä –Ω–∞–∑–Ω–∞—á–µ–Ω';\n  } else if (funnel.startsWith('5.')) {\n    funnel = 'üö∂ 1—ã–π –≤–∏–∑–∏—Ç –º–∞—Å—Ç–µ—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω';\n  } else if (funnel.startsWith('6.')) {\n    funnel = 'üí≥ –¶–µ–Ω–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∞ –Ω–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç—É';\n  } else if (funnel.startsWith('7.')) {\n    funnel = '‚úÖ –ö–ª–∏–µ–Ω—Ç –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª';\n  } else if (funnel.startsWith('10.')) {\n    funnel = 'ü™õ –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–∏–ª –Ω–∞ –¥–æ—Ä–∞–±–æ—Ç–∫—É';\n  }\n  \n  aggregatedText += `‚û§ <b>–ó–∞—è–≤–∫–∞ ‚Ññ${rowNumber}</b>\\n\\n`;\n  aggregatedText += `‚Ä¢ üë§ <b>–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–π —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç:</b> <i>${specialist}</i>\\n`;\n  aggregatedText += `‚Ä¢ üìÉ <b>–û–ø–∏—Å–∞–Ω–∏–µ —Ä–∞–±–æ—Ç:</b> <i>${description}</i>\\n`;\n  aggregatedText += `‚Ä¢ üìÖ <b>–î–∞—Ç–∞ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è:</b> <i>${executionDate}</i>\\n`;\n  aggregatedText += `‚Ä¢ üï∞ <b>–í—Ä–µ–º—è –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è:</b> <i>${executionTime}</i>\\n`;\n  aggregatedText += `‚Ä¢ üõ† <b>–°—Ç–∞—Ç—É—Å –∑–∞—è–≤–∫–∏:</b> <i>${getStatus(funnel)}</i>\\n`;\n  aggregatedText += `‚Ä¢ üí∞ <b>–°—Ç–æ–∏–º–æ—Å—Ç—å —Ä–∞–±–æ—Ç:</b> <i>${cost} ‚ÇΩ</i> ‚ÇΩ\\n`;\n  aggregatedText += `‚Ä¢ üóÉ <b>–î–æ–ø. –º–∞—Ç–µ—Ä–∏–∞–ª—ã:</b> <i>${additionalMaterials}</i>\\n`;\n  aggregatedText += `‚Ä¢ üí¨ <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:</b> <i>${comment}</i>\\n`;\n  aggregatedText += `‚Ä¢ üì∑ <b>–§–æ—Ç–æ:</b> <i>${photo}</i>\\n`;\n  \n  if (masterAppointed) {\n    aggregatedText += `‚Ä¢ üß∞ <b>–ú–∞—Å—Ç–µ—Ä –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å:</b><i> üëã ${masterAppointed}</i>\\n`;\n  }\n\n  aggregatedText += '\\n';\n});\n\nreturn [{ json: { aggregatedText } }];"},"id":"9d09fd1f-9e57-4bfa-a890-cf429c870ac8","name":"—Ç–µ–∫—Å—Ç5","type":"n8n-nodes-base.code","typeVersion":1,"position":[1780,640]},{"parameters":{"operation":"deleteMessage","chatId":"={{ $node[\"Webhook\"].json[\"query\"][\"telegram_id\"] }}","messageId":"={{ $node[\"Code\"].json[\"msgid\"] }}"},"id":"7052953f-fbd5-4a96-a134-e236686e845d","name":"—É–¥–∞–ª–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ8","type":"n8n-nodes-base.telegram","typeVersion":1,"position":[1940,640],"credentials":{"telegramApi":{"id":"33","name":"–ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å —É—Å–ª—É–≥–∏"}}},{"parameters":{"chatId":"={{ $node[\"Webhook\"].json[\"query\"][\"telegram_id\"] }}","text":"=<b>–ó–∞—è–≤–∫–∞ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏</b> üëá\n\n{{ $node[\"—Ç–µ–∫—Å—Ç5\"].json[\"aggregatedText\"] }}\n\n\nüëâ‚úÖ –ù–∞–∂–º–∏—Ç–µ \"–í—ã–ø–æ–ª–Ω–µ–Ω–æ\", —á—Ç–æ–±—ã –ø—Ä–∏–Ω—è—Ç—å —Ä–∞–±–æ—Ç—É.\n","replyMarkup":"inlineKeyboard","inlineKeyboard":{"rows":[{"row":{"buttons":[{"text":"‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ","additionalFields":{"callback_data":"–í—ã–ø–æ–ª–Ω–µ–Ω–æ"}}]}},{"row":{"buttons":[{"text":"üîµ –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç","additionalFields":{"callback_data":"–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç"}}]}}]},"additionalFields":{"parse_mode":"HTML"}},"id":"546e2689-783a-4265-9257-5106de929b2a","name":"Telegram6","type":"n8n-nodes-base.telegram","typeVersion":1,"position":[2100,640],"credentials":{"telegramApi":{"id":"33","name":"–ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å —É—Å–ª—É–≥–∏"}}},{"parameters":{"conditions":{"string":[{"value1":"={{ $json[\"–í–æ—Ä–æ–Ω–∫–∞\"] }}","value2":"4. –º–∞—Å—Ç–µ—Ä –Ω–∞–∑–Ω–∞—á–µ–Ω"}]}},"id":"37ea2bed-6b06-4df1-8533-cbc167fa3b7f","name":"IF4","type":"n8n-nodes-base.if","typeVersion":1,"position":[1600,720]},{"parameters":{"jsCode":"let aggregatedText = '';\n\nitems.forEach(item => {\n  const rowNumber = item.json.row_number;\n  const specialist = item.json['–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç'];\n  let description = item.json['–ó–∞–¥–∞—á–∞'];\n  let date = item.json['–î–∞—Ç–∞ –∑–∞–∫–∞–∑–∞'];\n  let time = item.json['–í—Ä–µ–º—è –∑–∞–∫–∞–∑–∞'];\n  let funnel = item.json['–í–æ—Ä–æ–Ω–∫–∞'];\n  const masterAppointed = item.json['–ú–∞—Å—Ç–µ—Ä –Ω–∞–∑–Ω–∞—á–µ–Ω'];\n  let cost = '';\n  let additionalMaterials = '';\n  let comment = '';\n  let photo = '';\n  let showAdditionalInfo = false;\n\n  if (funnel === \"6. —Ü–µ–Ω–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∞ –Ω–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç—É\") {\n      date = item.json['–î–∞—Ç–∞ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è'];\n      time = item.json['–í—Ä–µ–º—è –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è'];\n      description = item.json['–û–ø–∏—Å–∞–Ω–∏–µ —Ä–∞–±–æ—Ç'];\n      cost = item.json['–°—Ç–æ–∏–º–æ—Å—Ç—å —Ä–∞–±–æ—Ç'] || \"–ù–µ—Ç\";\n      additionalMaterials = item.json['–î–æ–ø. –º–∞—Ç–µ—Ä–∏–∞–ª—ã'] || \"–ù–µ—Ç\";\n      comment = item.json['–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π'] || \"–ù–µ—Ç\";\n      photo = item.json['–§–æ—Ç–æ'] || \"–ù–µ—Ç\";\n  } else if (funnel === \"7. –∫–ª–∏–µ–Ω—Ç –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª\" || funnel === \"10. –∫–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–∏–ª –Ω–∞ –¥–æ—Ä–∞–±–æ—Ç–∫—É\") {\n      cost = item.json['–°—Ç–æ–∏–º–æ—Å—Ç—å —Ä–∞–±–æ—Ç'] || \"–ù–µ—Ç\";\n      additionalMaterials = item.json['–î–æ–ø. –º–∞—Ç–µ—Ä–∏–∞–ª—ã'] || \"–ù–µ—Ç\";\n      comment = item.json['–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π'] || \"–ù–µ—Ç\";\n      photo = item.json['–§–æ—Ç–æ'] || \"–ù–µ—Ç\";\n      showAdditionalInfo = true;\n  } else if (funnel === \"3. –∑–∞—è–≤–∫–∞ –ø–µ—Ä–µ–¥–∞–Ω–∞ –º–∞—Å—Ç–µ—Ä–∞–º\") {\n      funnel = 'ü´¥ –∑–∞—è–≤–∫–∞ –ø–µ—Ä–µ–¥–∞–Ω–∞ –º–∞—Å—Ç–µ—Ä–∞–º';\n  }\n\n  if (funnel.startsWith('4.')) {\n    funnel = 'üìù –º–∞—Å—Ç–µ—Ä –Ω–∞–∑–Ω–∞—á–µ–Ω';\n  } else if (funnel.startsWith('5.')) {\n    funnel = 'üö∂ 1—ã–π –≤–∏–∑–∏—Ç –º–∞—Å—Ç–µ—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω';\n  } else if (funnel.startsWith('6.')) {\n    funnel = 'üí≥ —Ü–µ–Ω–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∞ –Ω–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç—É';\n  } else if (funnel.startsWith('7.')) {\n    funnel = '‚úÖ –∫–ª–∏–µ–Ω—Ç –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª';\n  } else if (funnel.startsWith('10.')) {\n    funnel = 'üîß –∫–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–∏–ª –Ω–∞ –¥–æ—Ä–∞–±–æ—Ç–∫—É';\n  }\n\n  aggregatedText += `‚û§ <b>–ó–∞—è–≤–∫–∞ ‚Ññ${rowNumber}</b>\\n\\n`;\n  aggregatedText += `‚Ä¢ üë§<b>–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–π —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç:</b> <i>${specialist}</i>\\n`;\n  aggregatedText += `‚Ä¢ üìÉ<b>–û–ø–∏—Å–∞–Ω–∏–µ —Ä–∞–±–æ—Ç:</b> <i>${description}</i>\\n`;\n  aggregatedText += `‚Ä¢ üìÖ<b>–î–∞—Ç–∞:</b> <i>${date}</i>\\n`;\n  aggregatedText += `‚Ä¢ üï∞<b>–í—Ä–µ–º—è:</b> <i>${time}</i>\\n`;\n  aggregatedText += `‚Ä¢ üõ† <b>–°—Ç–∞—Ç—É—Å –∑–∞—è–≤–∫–∏:</b> <i>${funnel}</i>\\n`;\n\n  if (cost) {\n    aggregatedText += `‚Ä¢ üí∞ <b>–°—Ç–æ–∏–º–æ—Å—Ç—å —Ä–∞–±–æ—Ç:</b> <i>${cost}</i>\\n`;\n  }\n  \n  if (additionalMaterials) {\n    aggregatedText += `‚Ä¢ üõí <b>–î–æ–ø. –º–∞—Ç–µ—Ä–∏–∞–ª—ã:</b> <i>${additionalMaterials}</i>\\n`;\n  }\n  \n  if (comment) {\n    aggregatedText += `‚Ä¢ üí¨ <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:</b> <i>${comment}</i>\\n`;\n  }\n  \n  if (photo) {\n    aggregatedText += `‚Ä¢ üì∑ <b>–§–æ—Ç–æ:</b> <i>${photo}</i>\\n`;\n  }\n\n  if (showAdditionalInfo && masterAppointed) {\n    aggregatedText += `‚Ä¢ üß∞ <b>–ú–∞—Å—Ç–µ—Ä –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å:</b><i>üëã ${masterAppointed}</i>\\n`;\n  } else if (masterAppointed) {\n    aggregatedText += `‚Ä¢ üß∞ <b>–í–∞–º –Ω–∞–∑–Ω–∞—á–µ–Ω –º–∞—Å—Ç–µ—Ä: </b><i>üëã ${masterAppointed}</i>\\n`;\n  }\n\n  aggregatedText += '\\n';\n});\n\nreturn [{json: {aggregatedText: aggregatedText}}];"},"id":"142b8452-4968-42f7-b14c-7da4c84681d7","name":"—Ç–µ–∫—Å—Ç6","type":"n8n-nodes-base.code","typeVersion":1,"position":[1780,1040]},{"parameters":{"operation":"deleteMessage","chatId":"={{ $node[\"Webhook\"].json[\"query\"][\"telegram_id\"] }}","messageId":"={{ $node[\"Code\"].json[\"msgid\"] }}"},"id":"ebc24a43-5bf4-4759-8c6a-aebb9403beff","name":"—É–¥–∞–ª–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ9","type":"n8n-nodes-base.telegram","typeVersion":1,"position":[1940,1040],"credentials":{"telegramApi":{"id":"33","name":"–ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å —É—Å–ª—É–≥–∏"}}},{"parameters":{"chatId":"={{ $node[\"Webhook\"].json[\"query\"][\"telegram_id\"] }}","text":"=<b>–ó–∞—è–≤–∫–∞ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏</b> üëá\n\n{{ $node[\"—Ç–µ–∫—Å—Ç6\"].json[\"aggregatedText\"] }}\n\n","replyMarkup":"inlineKeyboard","inlineKeyboard":{"rows":[{"row":{"buttons":[{"text":"üîµ –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç","additionalFields":{"callback_data":"–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç"}}]}}]},"additionalFields":{"parse_mode":"HTML"}},"id":"8d26124f-9bbd-4818-8c80-dd4bf6853f6f","name":"Telegram7","type":"n8n-nodes-base.telegram","typeVersion":1,"position":[2100,1040],"credentials":{"telegramApi":{"id":"33","name":"–ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å —É—Å–ª—É–≥–∏"}}},{"parameters":{"conditions":{"string":[{"value1":"={{ $json[\"x\"] }}","value2":"6"}]}},"id":"0ddb64c3-3e1b-4ea8-8fa0-5828892bdd36","name":"IF1","type":"n8n-nodes-base.if","typeVersion":1,"position":[-220,1000]},{"parameters":{"documentId":{"__rl":true,"value":"1_mVTlW_BvNIQ30QbtAC59sPq3-ynnggfG01WI4A0WjE","mode":"list","cachedResultName":"–ó–∞–∫–∞–∑—ã –∫–ª–∏–µ–Ω—Ç–æ–≤(–º–∞—Ä–∫–µ—Ç–ø–ª—ç–π—Å —É—Å–ª—É–≥)","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1_mVTlW_BvNIQ30QbtAC59sPq3-ynnggfG01WI4A0WjE/edit?usp=drivesdk"},"sheetName":{"__rl":true,"value":"gid=0","mode":"list","cachedResultName":"–ó–∞–∫–∞–∑—ã –∫–ª–∏–µ–Ω—Ç–æ–≤(–º–∞—Ä–∫–µ—Ç–ø–ª—ç–π—Å —É—Å–ª—É–≥)","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1_mVTlW_BvNIQ30QbtAC59sPq3-ynnggfG01WI4A0WjE/edit#gid=0"},"filtersUI":{"values":[{"lookupColumn":"–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è","lookupValue":"={{ $node[\"Code\"].json[\"klient_otvet_order\"] }}"}]},"options":{}},"id":"d43c1e69-2059-4821-ac8a-4025710cd887","name":"Google Sheets11","type":"n8n-nodes-base.googleSheets","typeVersion":3,"position":[-60,880],"credentials":{"googleSheetsOAuth2Api":{"id":"27","name":"Google Sheets account"}}},{"parameters":{"operation":"update","documentId":{"__rl":true,"value":"1_mVTlW_BvNIQ30QbtAC59sPq3-ynnggfG01WI4A0WjE","mode":"list","cachedResultName":"–ó–∞–∫–∞–∑—ã –∫–ª–∏–µ–Ω—Ç–æ–≤(–º–∞—Ä–∫–µ—Ç–ø–ª—ç–π—Å —É—Å–ª—É–≥)","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1_mVTlW_BvNIQ30QbtAC59sPq3-ynnggfG01WI4A0WjE/edit?usp=drivesdk"},"sheetName":{"__rl":true,"value":"gid=0","mode":"list","cachedResultName":"–ó–∞–∫–∞–∑—ã –∫–ª–∏–µ–Ω—Ç–æ–≤(–º–∞—Ä–∫–µ—Ç–ø–ª—ç–π—Å —É—Å–ª—É–≥)","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1_mVTlW_BvNIQ30QbtAC59sPq3-ynnggfG01WI4A0WjE/edit#gid=0"},"columnToMatchOn":"–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è","valueToMatchOn":"={{ $json[\"–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è\"] }}","fieldsUi":{"values":[{"column":"–í–æ—Ä–æ–Ω–∫–∞","fieldValue":"8. –∫–ª–∏–µ–Ω—Ç –æ—Ç–∫–∞–∑–∞–ª—Å—è"}]},"options":{}},"id":"4608af53-4617-40f9-9d09-c7733a561c25","name":"Google Sheets12","type":"n8n-nodes-base.googleSheets","typeVersion":3,"position":[100,880],"credentials":{"googleSheetsOAuth2Api":{"id":"27","name":"Google Sheets account"}}},{"parameters":{"documentId":{"__rl":true,"value":"1_mVTlW_BvNIQ30QbtAC59sPq3-ynnggfG01WI4A0WjE","mode":"list","cachedResultName":"–ó–∞–∫–∞–∑—ã –∫–ª–∏–µ–Ω—Ç–æ–≤(–º–∞—Ä–∫–µ—Ç–ø–ª—ç–π—Å —É—Å–ª—É–≥)","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1_mVTlW_BvNIQ30QbtAC59sPq3-ynnggfG01WI4A0WjE/edit?usp=drivesdk"},"sheetName":{"__rl":true,"value":"gid=0","mode":"list","cachedResultName":"–ó–∞–∫–∞–∑—ã –∫–ª–∏–µ–Ω—Ç–æ–≤(–º–∞—Ä–∫–µ—Ç–ø–ª—ç–π—Å —É—Å–ª—É–≥)","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1_mVTlW_BvNIQ30QbtAC59sPq3-ynnggfG01WI4A0WjE/edit#gid=0"},"filtersUI":{"values":[{"lookupColumn":"–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è","lookupValue":"={{ $node[\"Code\"].json[\"klient_otvet_order\"] }}"}]},"options":{}},"id":"c4d45f12-88d0-4ab5-a0e2-0f4d21146595","name":"Google Sheets13","type":"n8n-nodes-base.googleSheets","typeVersion":3,"position":[260,880],"credentials":{"googleSheetsOAuth2Api":{"id":"27","name":"Google Sheets account"}}},{"parameters":{"jsCode":"let aggregatedText = '';\n\nitems.forEach(item => {\n  const rowNumber = item.json.row_number;\n  let funnel = item.json['–í–æ—Ä–æ–Ω–∫–∞'];\n\n  funnel = funnel.slice(funnel.indexOf('.') + 2); // —É–¥–∞–ª—è–µ–º —á–∏—Å–ª–æ –∏ —Ç–æ—á–∫—É\n\n  aggregatedText += `‚ùå <b>–ó–∞—è–≤–∫–∞ ‚Ññ${rowNumber}</b>`;\n  aggregatedText += `\\n<i>–°—Ç–∞—Ç—É—Å –∑–∞—è–≤–∫–∏ –∏–∑–º–µ–Ω–∏–ª—Å—è –Ω–∞ ${funnel}</i> ‚úç\\n\\n`;\n});\n\nreturn [{json: {aggregatedText}}];"},"id":"9d5237b3-5c11-46e4-9b5d-c09bac8c509d","name":"Code3","type":"n8n-nodes-base.code","typeVersion":1,"position":[420,880]},{"parameters":{"operation":"deleteMessage","chatId":"={{ $node[\"Webhook\"].json[\"query\"][\"telegram_id\"] }}","messageId":"={{ $node[\"Code\"].json[\"msgid\"] }}"},"id":"56be0f5f-0363-48f1-afd5-af934095e683","name":"—É–¥–∞–ª–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ10","type":"n8n-nodes-base.telegram","typeVersion":1,"position":[580,880],"credentials":{"telegramApi":{"id":"33","name":"–ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å —É—Å–ª—É–≥–∏"}}},{"parameters":{"chatId":"={{ $node[\"Webhook\"].json[\"query\"][\"telegram_id\"] }}","text":"=<b>–°—Ç–∞—Ç—É—Å –∑–∞—è–≤–∫–∏ –∏–∑–º–µ–Ω–∏–ª—Å—è</b> üëá\n\n{{ $node[\"Code3\"].json[\"aggregatedText\"] }}\n","replyMarkup":"inlineKeyboard","inlineKeyboard":{"rows":[{"row":{"buttons":[{"text":"üîµ –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç","additionalFields":{"callback_data":"–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç"}}]}}]},"additionalFields":{"parse_mode":"HTML"}},"id":"f25877d9-96d9-4aab-ba87-f42e5adb9f51","name":"Telegram8","type":"n8n-nodes-base.telegram","typeVersion":1,"position":[740,880],"credentials":{"telegramApi":{"id":"33","name":"–ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å —É—Å–ª—É–≥–∏"}}},{"parameters":{"content":"–ü–û–î–¢–í–ï–†–ñ–î–ï–ù–ò–ï –ó–ê–Ø–í–ö–ò","height":180.2136760045373,"width":478.52137685354023},"id":"2b4e1fda-af9d-452b-812a-7ae4191db0ac","name":"Sticky Note","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[1149.465809988657,400]},{"parameters":{"content":"–û–¢–ö–ê–ó –û–¢ –í–´–ü–û–õ–ù–ï–ù–ò–Ø –ó–ê–Ø–í–ö–ò","height":186.27777880589855,"width":1660.7468931937037},"id":"f5a08bb1-84d6-473a-99e4-0b509bc715de","name":"Sticky Note1","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-100,833.7222211941015]},{"parameters":{"content":"–∑–ê–Ø–í–ö–ê –ü–ï–†–ï–î–ê–ù–ê –ú–ê–°–¢–ï–†–ê–ú","height":176.17094080362992,"width":533.0983020657917},"id":"570417a1-6f16-4f2c-bf51-ce504158b07b","name":"Sticky Note2","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[1740,1003.8290591963705]},{"parameters":{"content":"–ú–ê–°–¢–ï–† –ù–ê–ó–ù–ê–ß–ï–ù","height":176.17094080362995,"width":533.0983020657914},"id":"f8e6e8d8-04db-483e-a722-49216e64199a","name":"Sticky Note3","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[1740,803.8290591963705]},{"parameters":{"content":"–í–´–ü–û–õ–ù–ï–ù–û","height":184.25641120544483,"width":1658.121935826043},"id":"335a334a-b0e7-42bd-ae0a-b6506658d849","name":"Sticky Note4","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-94.14957320317603,1035.7435887945553]},{"parameters":{"content":"–ü–†–ò–ù–Ø–¢–¨ –ó–ê–Ø–í–ö–£","height":180.21367600453738,"width":1653.063815970024},"id":"963eb135-92b7-4e5d-b53e-f15bf81ba32f","name":"Sticky Note5","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-100,1439.7863239954631]},{"parameters":{"content":"–î–û–î–ï–õ–ê–¢–¨","height":178.19230840408355,"width":1658.323132415111},"id":"6ef548c3-3f84-4a79-87ab-91e48a1a2bd5","name":"Sticky Note6","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-100,1241.8076915959166]},{"parameters":{"content":"–ö–õ–ò–ï–ù–¢ –ü–û–î–¢–í–ï–†–î–ò–õ","height":190.32051400680612,"width":533.0983020657911},"id":"24ff873f-ee1f-4756-8943-68913eaf72c5","name":"Sticky Note7","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[1740,401.38033958684167]},{"parameters":{"content":"–ó–ê–Ø–í–ö–ê –í –î–û–†–ê–ë–û–¢–ö–ï","height":184.25641120544483,"width":531.0769344653373},"id":"064b3cef-bb7b-4948-bfa0-0d6a747980d7","name":"Sticky Note8","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[1740,600]},{"parameters":{"jsCode":"let aggregatedText = '';\n\nitems.forEach(item => {\n  const rowNumber = item.json.row_number;\n  const specialist = item.json['–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç'];\n  const task = item.json['–ó–∞–¥–∞—á–∞'];\n  const date = item.json['–î–∞—Ç–∞ –∑–∞–∫–∞–∑–∞'];\n  const time = item.json['–í—Ä–µ–º—è –∑–∞–∫–∞–∑–∞'];\n  let funnel = item.json['–í–æ—Ä–æ–Ω–∫–∞'];\n  const masterAppointed = item.json['–ú–∞—Å—Ç–µ—Ä –Ω–∞–∑–Ω–∞—á–µ–Ω'];\n\n  if (funnel.startsWith('4.')) {\n    funnel = 'üìù –º–∞—Å—Ç–µ—Ä –Ω–∞–∑–Ω–∞—á–µ–Ω';\n  } else if (funnel.startsWith('5.')) {\n    funnel = 'üö∂ 1—ã–π –≤–∏–∑–∏—Ç –º–∞—Å—Ç–µ—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω';\n  } else if (funnel.startsWith('6.')) {\n    funnel = 'üí≥ —Ü–µ–Ω–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∞ –Ω–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç—É';\n  } else if (funnel.startsWith('7.')) {\n    funnel = '‚úÖ –∫–ª–∏–µ–Ω—Ç –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª';\n  } else if (funnel.startsWith('10.')) {\n    funnel = 'ü™õ –∫–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–∏–ª –Ω–∞ –¥–æ—Ä–∞–±–æ—Ç–∫—É';\n  }\n\n  aggregatedText += `‚û§ <b>–ó–∞—è–≤–∫–∞ ‚Ññ${rowNumber}</b>\\n\\n`;\n  aggregatedText += `‚Ä¢ üë§<b>–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–π —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç:</b> <i>${specialist}</i>\\n`;\n  aggregatedText += `‚Ä¢ üìÉ<b>–ó–∞–¥–∞—á–∞:</b> <i>${task}</i>\\n`;\n  aggregatedText += `‚Ä¢ üìÖ<b>–î–∞—Ç–∞:</b> <i>${date}</i>\\n`;\n  aggregatedText += `‚Ä¢ üï∞<b>–í—Ä–µ–º—è:</b> <i>${time}</i>\\n`;\n  aggregatedText += `‚Ä¢ üõ† <b>–°—Ç–∞—Ç—É—Å –∑–∞—è–≤–∫–∏:</b> <i>${funnel}</i>\\n`;\n\n  if (masterAppointed) {\n    aggregatedText += `‚Ä¢ üß∞ <b>–í–∞–º –Ω–∞–∑–Ω–∞—á–µ–Ω –º–∞—Å—Ç–µ—Ä: </b><i>üëã ${masterAppointed}</i>\\n`\n  }\n\n  aggregatedText += '\\n';\n});\n\nreturn [{json: {aggregatedText: aggregatedText}}];"},"id":"f6473573-27ea-4c09-a2de-1cf548db4e55","name":"—Ç–µ–∫—Å—Ç8","type":"n8n-nodes-base.code","typeVersion":1,"position":[2100,-400]},{"parameters":{"jsCode":"let aggregatedText = '';\n\nitems.forEach(item => {\n  const rowNumber = item.json.row_number;\n  const specialist = item.json['–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç'];\n  let description = item.json['–ó–∞–¥–∞—á–∞'];\n  let date = item.json['–î–∞—Ç–∞ –∑–∞–∫–∞–∑–∞'];\n  let time = item.json['–í—Ä–µ–º—è –∑–∞–∫–∞–∑–∞'];\n  let funnel = item.json['–í–æ—Ä–æ–Ω–∫–∞'];\n  const masterAppointed = item.json['–ú–∞—Å—Ç–µ—Ä –Ω–∞–∑–Ω–∞—á–µ–Ω'];\n  let cost = '';\n  let additionalMaterials = '';\n  let comment = '';\n  let photo = '';\n  let showAdditionalInfo = false;\n\n  if (funnel === \"6. —Ü–µ–Ω–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∞ –Ω–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç—É\") {\n      date = item.json['–î–∞—Ç–∞ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è'];\n      time = item.json['–í—Ä–µ–º—è –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è'];\n      description = item.json['–û–ø–∏—Å–∞–Ω–∏–µ —Ä–∞–±–æ—Ç'];\n      cost = item.json['–°—Ç–æ–∏–º–æ—Å—Ç—å —Ä–∞–±–æ—Ç'] || \"–ù–µ—Ç\";\n      additionalMaterials = item.json['–î–æ–ø. –º–∞—Ç–µ—Ä–∏–∞–ª—ã'] || \"–ù–µ—Ç\";\n      comment = item.json['–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π'] || \"–ù–µ—Ç\";\n      photo = item.json['–§–æ—Ç–æ'] || \"–ù–µ—Ç\";\n  } else if (funnel === \"7. –∫–ª–∏–µ–Ω—Ç –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª\" || funnel === \"10. –∫–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–∏–ª –Ω–∞ –¥–æ—Ä–∞–±–æ—Ç–∫—É\") {\n      cost = item.json['–°—Ç–æ–∏–º–æ—Å—Ç—å —Ä–∞–±–æ—Ç'] || \"–ù–µ—Ç\";\n      additionalMaterials = item.json['–î–æ–ø. –º–∞—Ç–µ—Ä–∏–∞–ª—ã'] || \"–ù–µ—Ç\";\n      comment = item.json['–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π'] || \"–ù–µ—Ç\";\n      photo = item.json['–§–æ—Ç–æ'] || \"–ù–µ—Ç\";\n      showAdditionalInfo = true;\n  }\n\n  if (funnel.startsWith('4.')) {\n    funnel = 'üìù –º–∞—Å—Ç–µ—Ä –Ω–∞–∑–Ω–∞—á–µ–Ω';\n  } else if (funnel.startsWith('5.')) {\n    funnel = 'üö∂ 1—ã–π –≤–∏–∑–∏—Ç –º–∞—Å—Ç–µ—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω';\n  } else if (funnel.startsWith('6.')) {\n    funnel = 'üí≥ —Ü–µ–Ω–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∞ –Ω–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç—É';\n  } else if (funnel.startsWith('7.')) {\n    funnel = '‚úÖ –∫–ª–∏–µ–Ω—Ç –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª';\n  } else if (funnel.startsWith('10.')) {\n    funnel = 'ü™õ –∫–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–∏–ª –Ω–∞ –¥–æ—Ä–∞–±–æ—Ç–∫—É';\n  }\n\n  aggregatedText += `‚û§ <b>–ó–∞—è–≤–∫–∞ ‚Ññ${rowNumber}</b>\\n\\n`;\n  aggregatedText += `‚Ä¢ üë§<b>–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–π —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç:</b> <i>${specialist}</i>\\n`;\n  aggregatedText += `‚Ä¢ üìÉ<b>–û–ø–∏—Å–∞–Ω–∏–µ —Ä–∞–±–æ—Ç:</b> <i>${description}</i>\\n`;\n  aggregatedText += `‚Ä¢ üìÖ<b>–î–∞—Ç–∞:</b> <i>${date}</i>\\n`;\n  aggregatedText += `‚Ä¢ üï∞<b>–í—Ä–µ–º—è:</b> <i>${time}</i>\\n`;\n  aggregatedText += `‚Ä¢ üõ† <b>–°—Ç–∞—Ç—É—Å –∑–∞—è–≤–∫–∏:</b> <i>${funnel}</i>\\n`;\n\n  if (cost) {\n    aggregatedText += `‚Ä¢ üí∞ <b>–°—Ç–æ–∏–º–æ—Å—Ç—å —Ä–∞–±–æ—Ç:</b> <i>${cost}</i>\\n`;\n  }\n  \n  if (additionalMaterials) {\n    aggregatedText += `‚Ä¢ üõí <b>–î–æ–ø. –º–∞—Ç–µ—Ä–∏–∞–ª—ã:</b> <i>${additionalMaterials}</i>\\n`;\n  }\n  \n  if (comment) {\n    aggregatedText += `‚Ä¢ üí¨ <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:</b> <i>${comment}</i>\\n`;\n  }\n  \n  if (photo) {\n    aggregatedText += `‚Ä¢ üì∑ <b>–§–æ—Ç–æ:</b> <i>${photo}</i>\\n`;\n  }\n\n  if (showAdditionalInfo && masterAppointed) {\n    aggregatedText += `‚Ä¢ üß∞ <b>–ú–∞—Å—Ç–µ—Ä –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å:</b><i>üëã ${masterAppointed}</i>\\n`;\n  } else if (masterAppointed) {\n    aggregatedText += `‚Ä¢ üß∞ <b>–í–∞–º –Ω–∞–∑–Ω–∞—á–µ–Ω –º–∞—Å—Ç–µ—Ä: </b><i>üëã ${masterAppointed}</i>\\n`;\n  }\n\n  aggregatedText += '\\n';\n});\n\nreturn [{json: {aggregatedText: aggregatedText}}];"},"id":"ec6fe340-76ca-416f-8478-fd0f372e2152","name":"—Ç–µ–∫—Å—Ç7","type":"n8n-nodes-base.code","typeVersion":1,"position":[1920,-400]},{"parameters":{"content":"–¢–ï–ö–£–©–ò–• –ó–ê–Ø–í–û–ö –ù–ï–¢","height":205.48077101020894,"width":469.930564551612},"id":"e9ce8a1f-2823-4233-ab42-c345fb4cf04b","name":"Sticky Note9","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[500,-120]},{"parameters":{"content":"–í–°–ï –¢–ï–ö–£–©–ò–ï –ó–ê–Ø–í–ö–ò","height":331.8162460385672,"width":954.9570579275392},"id":"bc4f244d-b2b2-42b7-a9af-9134ea636e2a","name":"Sticky Note10","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[1240,20]},{"parameters":{"jsCode":"let aggregatedText = '';\n\nitems.forEach(item => {\n  const rowNumber = item.json.row_number;\n  const specialist = item.json['–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç'];\n  let description = item.json['–ó–∞–¥–∞—á–∞'];\n  let date = item.json['–î–∞—Ç–∞ –∑–∞–∫–∞–∑–∞'];\n  let time = item.json['–í—Ä–µ–º—è –∑–∞–∫–∞–∑–∞'];\n  let funnel = item.json['–í–æ—Ä–æ–Ω–∫–∞'];\n  const masterAppointed = item.json['–ú–∞—Å—Ç–µ—Ä –Ω–∞–∑–Ω–∞—á–µ–Ω'];\n  let cost = '';\n  let additionalMaterials = '';\n  let comment = '';\n  let photo = '';\n  let showAdditionalInfo = false;\n\n  if (funnel === \"6. —Ü–µ–Ω–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∞ –Ω–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç—É\") {\n      date = item.json['–î–∞—Ç–∞ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è'];\n      time = item.json['–í—Ä–µ–º—è –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è'];\n      description = item.json['–û–ø–∏—Å–∞–Ω–∏–µ —Ä–∞–±–æ—Ç'];\n      cost = item.json['–°—Ç–æ–∏–º–æ—Å—Ç—å —Ä–∞–±–æ—Ç'] || \"–ù–µ—Ç\";\n      additionalMaterials = item.json['–î–æ–ø. –º–∞—Ç–µ—Ä–∏–∞–ª—ã'] || \"–ù–µ—Ç\";\n      comment = item.json['–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π'] || \"–ù–µ—Ç\";\n      photo = item.json['–§–æ—Ç–æ'] || \"–ù–µ—Ç\";\n  } else if (funnel === \"7. –∫–ª–∏–µ–Ω—Ç –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª\" || funnel === \"10. –∫–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–∏–ª –Ω–∞ –¥–æ—Ä–∞–±–æ—Ç–∫—É\") {\n      cost = item.json['–°—Ç–æ–∏–º–æ—Å—Ç—å —Ä–∞–±–æ—Ç'] || \"–ù–µ—Ç\";\n      additionalMaterials = item.json['–î–æ–ø. –º–∞—Ç–µ—Ä–∏–∞–ª—ã'] || \"–ù–µ—Ç\";\n      comment = item.json['–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π'] || \"–ù–µ—Ç\";\n      photo = item.json['–§–æ—Ç–æ'] || \"–ù–µ—Ç\";\n      showAdditionalInfo = true;\n  }\n\n  if (funnel.startsWith('4.')) {\n    funnel = 'üìù –º–∞—Å—Ç–µ—Ä –Ω–∞–∑–Ω–∞—á–µ–Ω';\n  } else if (funnel.startsWith('5.')) {\n    funnel = 'üö∂ 1—ã–π –≤–∏–∑–∏—Ç –º–∞—Å—Ç–µ—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω';\n  } else if (funnel.startsWith('6.')) {\n    funnel = 'üí≥ —Ü–µ–Ω–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∞ –Ω–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç—É';\n  } else if (funnel.startsWith('7.')) {\n    funnel = '‚úÖ –∫–ª–∏–µ–Ω—Ç –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª';\n  } else if (funnel.startsWith('10.')) {\n    funnel = 'üîß –∫–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–∏–ª –Ω–∞ –¥–æ—Ä–∞–±–æ—Ç–∫—É';\n  }\n\n  aggregatedText += `‚û§ <b>–ó–∞—è–≤–∫–∞ ‚Ññ${rowNumber}</b>\\n\\n`;\n  aggregatedText += `‚Ä¢ üë§<b>–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–π —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç:</b> <i>${specialist}</i>\\n`;\n  aggregatedText += `‚Ä¢ üìÉ<b>–û–ø–∏—Å–∞–Ω–∏–µ —Ä–∞–±–æ—Ç:</b> <i>${description}</i>\\n`;\n  aggregatedText += `‚Ä¢ üìÖ<b>–î–∞—Ç–∞:</b> <i>${date}</i>\\n`;\n  aggregatedText += `‚Ä¢ üï∞<b>–í—Ä–µ–º—è:</b> <i>${time}</i>\\n`;\n  aggregatedText += `‚Ä¢ üõ† <b>–°—Ç–∞—Ç—É—Å –∑–∞—è–≤–∫–∏:</b> <i>${funnel}</i>\\n`;\n\n  if (cost) {\n    aggregatedText += `‚Ä¢ üí∞ <b>–°—Ç–æ–∏–º–æ—Å—Ç—å —Ä–∞–±–æ—Ç:</b> <i>${cost}</i>\\n`;\n  }\n  \n  if (additionalMaterials) {\n    aggregatedText += `‚Ä¢ üõí <b>–î–æ–ø. –º–∞—Ç–µ—Ä–∏–∞–ª—ã:</b> <i>${additionalMaterials}</i>\\n`;\n  }\n  \n  if (comment) {\n    aggregatedText += `‚Ä¢ üí¨ <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:</b> <i>${comment}</i>\\n`;\n  }\n  \n  if (photo) {\n    aggregatedText += `‚Ä¢ üì∑ <b>–§–æ—Ç–æ:</b> <i>${photo}</i>\\n`;\n  }\n\n  if (showAdditionalInfo && masterAppointed) {\n    aggregatedText += `‚Ä¢ üß∞ <b>–ú–∞—Å—Ç–µ—Ä –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å:</b><i>üëã ${masterAppointed}</i>\\n`;\n  } else if (masterAppointed) {\n    aggregatedText += `‚Ä¢ üß∞ <b>–í–∞–º –Ω–∞–∑–Ω–∞—á–µ–Ω –º–∞—Å—Ç–µ—Ä: </b><i>üëã ${masterAppointed}</i>\\n`;\n  }\n\n  aggregatedText += '\\n';\n});\n\nreturn [{json: {aggregatedText: aggregatedText}}];"},"id":"0b0bd9a9-80a9-4e26-aac9-b07e71ccee61","name":"—Ç–µ–∫—Å—Ç9","type":"n8n-nodes-base.code","typeVersion":1,"position":[1300,-120]},{"parameters":{"jsCode":"function getStatus(funnel) {\n  switch (funnel.split('.')[0]) {\n    case '4': return 'üìù –ú–∞—Å—Ç–µ—Ä –Ω–∞–∑–Ω–∞—á–µ–Ω';\n    case '5': return 'üö∂ 1—ã–π –≤–∏–∑–∏—Ç –º–∞—Å—Ç–µ—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω';\n    case '6': return 'üí≥ –¶–µ–Ω–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∞ –Ω–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç—É';\n    case '7': return '‚úÖ –ö–ª–∏–µ–Ω—Ç –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª';\n    case '10': return 'ü™õ –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–∏–ª –Ω–∞ –¥–æ—Ä–∞–±–æ—Ç–∫—É';\n    default: return funnel;\n  }\n}\n\nlet aggregatedText = '';\nitems.forEach(item => {\n  const rowNumber = item.json.row_number;\n  const specialist = item.json['–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç'];\n  const description = item.json['–û–ø–∏—Å–∞–Ω–∏–µ —Ä–∞–±–æ—Ç'];\n  const executionDate = item.json['–î–∞—Ç–∞ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è'];\n  const executionTime = item.json['–í—Ä–µ–º—è –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è'];\n  let funnel = item.json['–í–æ—Ä–æ–Ω–∫–∞'];\n  const masterAppointed = item.json['–ú–∞—Å—Ç–µ—Ä –Ω–∞–∑–Ω–∞—á–µ–Ω'];\n  const cost = item.json['–°—Ç–æ–∏–º–æ—Å—Ç—å —Ä–∞–±–æ—Ç'] || '-';\n  const additionalMaterials = item.json['–î–æ–ø. –º–∞—Ç–µ—Ä–∏–∞–ª—ã'] || '-';\n  const comment = item.json['–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π'] || '-';\n  const photo = item.json['–§–æ—Ç–æ'] || '-';\n\n  if (funnel.startsWith('4.')) {\n    funnel = 'üìù –ú–∞—Å—Ç–µ—Ä –Ω–∞–∑–Ω–∞—á–µ–Ω';\n  } else if (funnel.startsWith('5.')) {\n    funnel = 'üö∂ 1—ã–π –≤–∏–∑–∏—Ç –º–∞—Å—Ç–µ—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω';\n  } else if (funnel.startsWith('6.')) {\n    funnel = 'üí≥ –¶–µ–Ω–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∞ –Ω–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç—É';\n  } else if (funnel.startsWith('7.')) {\n    funnel = '‚úÖ –ö–ª–∏–µ–Ω—Ç –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª';\n  } else if (funnel.startsWith('10.')) {\n    funnel = 'ü™õ –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–∏–ª –Ω–∞ –¥–æ—Ä–∞–±–æ—Ç–∫—É';\n  }\n  \n  aggregatedText += `‚û§ <b>–ó–∞—è–≤–∫–∞ ‚Ññ${rowNumber}</b>\\n\\n`;\n  aggregatedText += `‚Ä¢ üë§ <b>–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–π —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç:</b> <i>${specialist}</i>\\n`;\n  aggregatedText += `‚Ä¢ üìÉ <b>–û–ø–∏—Å–∞–Ω–∏–µ —Ä–∞–±–æ—Ç:</b> <i>${description}</i>\\n`;\n  aggregatedText += `‚Ä¢ üìÖ <b>–î–∞—Ç–∞ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è:</b> <i>${executionDate}</i>\\n`;\n  aggregatedText += `‚Ä¢ üï∞ <b>–í—Ä–µ–º—è –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è:</b> <i>${executionTime}</i>\\n`;\n  aggregatedText += `‚Ä¢ üõ† <b>–°—Ç–∞—Ç—É—Å –∑–∞—è–≤–∫–∏:</b> <i>${getStatus(funnel)}</i>\\n`;\n  aggregatedText += `‚Ä¢ üí∞ <b>–°—Ç–æ–∏–º–æ—Å—Ç—å —Ä–∞–±–æ—Ç:</b> <i>${cost} ‚ÇΩ</i>\\n`;\n  aggregatedText += `‚Ä¢ üóÉ <b>–î–æ–ø. –º–∞—Ç–µ—Ä–∏–∞–ª—ã:</b> <i>${additionalMaterials}</i>\\n`;\n  aggregatedText += `‚Ä¢ üí¨ <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:</b> <i>${comment}</i>\\n`;\n  aggregatedText += `‚Ä¢ üì∑ <b>–§–æ—Ç–æ:</b> <i>${photo}</i>\\n`;\n  \n  if (masterAppointed) {\n    aggregatedText += `‚Ä¢ üß∞ <b>–ú–∞—Å—Ç–µ—Ä –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å:</b><i> üëã ${masterAppointed}</i>\\n`;\n  }\n\n  aggregatedText += '\\n';\n});\n\nreturn [{ json: { aggregatedText } }];"},"id":"1b005821-fb7c-4c04-829d-45e6cfc333cc","name":"—Ç–µ–∫—Å—Ç10","type":"n8n-nodes-base.code","typeVersion":1,"position":[1780,1240]},{"parameters":{"operation":"deleteMessage","chatId":"={{ $node[\"Webhook\"].json[\"query\"][\"telegram_id\"] }}","messageId":"={{ $node[\"Code\"].json[\"msgid\"] }}"},"id":"49cc9ba7-4266-4379-8759-1677310b669c","name":"—É–¥–∞–ª–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ11","type":"n8n-nodes-base.telegram","typeVersion":1,"position":[1940,1240],"credentials":{"telegramApi":{"id":"33","name":"–ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å —É—Å–ª—É–≥–∏"}}},{"parameters":{"chatId":"={{ $node[\"Webhook\"].json[\"query\"][\"telegram_id\"] }}","text":"=<b>–ó–∞—è–≤–∫–∞ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏</b> üëá\n\n{{ $node[\"—Ç–µ–∫—Å—Ç10\"].json[\"aggregatedText\"] }}\n\nüì£ <b>–í–∞–∂–Ω–æ:</b> <i>–î–æ–∂–¥–∏—Ç–µ—Å—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ —É—Å–ª–æ–≤–∏—è—Ö –≤—ã–ø–æ–Ω–µ–Ω–∏—è –∑–∞—è–≤–∫–∏</i>","replyMarkup":"inlineKeyboard","inlineKeyboard":{"rows":[{"row":{"buttons":[{"text":"üîµ –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç","additionalFields":{"callback_data":"–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç"}}]}}]},"additionalFields":{"parse_mode":"HTML"}},"id":"938269e8-e6b5-482b-9d7c-4600236a9d1b","name":"Telegram9","type":"n8n-nodes-base.telegram","typeVersion":1,"position":[2120,1240],"credentials":{"telegramApi":{"id":"33","name":"–ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å —É—Å–ª—É–≥–∏"}}},{"parameters":{"content":"1—ã–π –≤–∏–∑–∏—Ç –º–∞—Å—Ç–µ—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω","height":186.59762219286654,"width":536.6657859973582},"id":"b344244f-3b52-4b9a-bbfe-4ac69c6ecad4","name":"Sticky Note11","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[1742.5056803170414,1193.4023778071328]},{"parameters":{"chatId":"={{ $node[\"Google Sheets5\"].json[\"TG ID\"] }}","text":"=<b>üí™ –ö–ª–∏–µ–Ω—Ç –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã –ø–æ –∑–∞—è–≤–∫–µ. –°–ø–∞—Å–∏–±–æ –∑–∞ –æ—Ç–ª–∏—á–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—É—é —Ä–∞–±–æ—Ç—É</b>\n\n{{ $node[\"Code1\"].json[\"aggregatedText\"] }}\n\n<i>–¢–µ–ø–µ—Ä—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–∞–Ω–Ω–æ–π –∑–∞—è–≤–∫–µ –±—É–¥–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å—Å—è –≤ —Ä–∞–∑–¥–µ–ª–µ \"–í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–∫–∞–∑—ã\" üóÇ</i>\n\nüì¢ <b>–í–ê–ñ–ù–û</b>: <i>—á—Ç–æ–±—ã —É–¥–∞–ª–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç –∑–∞–∫–∞–∑—á–∏–∫–∞ –∏ –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É \"–£–¥–∞–ª–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ\" ! –ü–µ—Ä–µ–π—Ç–∏ –≤ –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç –º–æ–∂–Ω–æ –ø–æ –∫–Ω–æ–ø–∫–µ \"–ú–µ–Ω—é\", —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–Ω–æ–π –≤ –Ω–∏–∂–Ω–µ–º –ª–µ–≤–æ–º —É–≥–ª—É.</i>","additionalFields":{"parse_mode":"HTML"}},"id":"80d304ac-a1ea-4844-99e2-3b70896e98a0","name":"Telegram10","type":"n8n-nodes-base.telegram","typeVersion":1,"position":[900,1080],"credentials":{"telegramApi":{"id":"33","name":"–ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å —É—Å–ª—É–≥–∏"}}},{"parameters":{"jsCode":"let message_id = $node[\"Telegram10\"].json[\"result\"][\"message_id\"].toString();\nreturn { message_id }"},"id":"af30cc77-c2ac-45dd-9117-c700a9d9b40e","name":"Code4","type":"n8n-nodes-base.code","typeVersion":1,"position":[1060,1080]},{"parameters":{"method":"POST","url":"https://app.leadteh.ru/api/v1/setContactVariable","authentication":"genericCredentialType","genericAuthType":"httpBasicAuth","sendHeaders":true,"headerParameters":{"parameters":[{"name":"X-Requested-With","value":"XMLHttpRequest"}]},"sendBody":true,"bodyParameters":{"parameters":[{"name":"api_token","value":"z3NKDDweLVTcwVNafiHKJUjwcSfTs17D2iGEzgmcIee9oclBLL5xRvqgGIVJ"},{"name":"contact_id","value":"={{ $node[\"Google Sheets5\"].json[\"ID LT master\"] }}"},{"name":"name","value":"notification_master"},{"name":"value","value":"‚ùå –£–¥–∞–ª–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ"},{"name":"deletable","value":"0"}]},"options":{"response":{"response":{"fullResponse":true,"neverError":true,"responseFormat":"text"}}}},"id":"0f352e1e-e5d6-43b6-961a-465b3a8e9125","name":"HTTP Request1","type":"n8n-nodes-base.httpRequest","typeVersion":4,"position":[1220,1080],"credentials":{"httpBasicAuth":{"id":"35","name":"Unnamed credential"}}},{"parameters":{"method":"POST","url":"https://app.leadteh.ru/api/v1/setContactVariable","authentication":"genericCredentialType","genericAuthType":"httpBasicAuth","sendHeaders":true,"headerParameters":{"parameters":[{"name":"X-Requested-With","value":"XMLHttpRequest"}]},"sendBody":true,"bodyParameters":{"parameters":[{"name":"api_token","value":"z3NKDDweLVTcwVNafiHKJUjwcSfTs17D2iGEzgmcIee9oclBLL5xRvqgGIVJ"},{"name":"contact_id","value":"={{ $node[\"Google Sheets5\"].json[\"ID LT master\"] }}"},{"name":"name","value":"notification_master_id"},{"name":"value","value":"={{ $node[\"Code4\"].json[\"message_id\"] }}"},{"name":"deletable","value":"0"}]},"options":{"response":{"response":{"fullResponse":true,"neverError":true,"responseFormat":"text"}}}},"id":"bdaf7902-dfb4-4132-9517-26919dd9f059","name":"HTTP Request2","type":"n8n-nodes-base.httpRequest","typeVersion":4,"position":[1380,1080],"credentials":{"httpBasicAuth":{"id":"35","name":"Unnamed credential"}}},{"parameters":{"chatId":"={{ $node[\"Google Sheets7\"].json[\"TG ID\"] }}","text":"=<b>üí™ –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–∏–ª –∑–∞—è–≤–∫—É –Ω–∞ –¥–æ—Ä–∞–±–æ—Ç–∫—É</b>\n\n{{ $node[\"Code2\"].json[\"aggregatedText\"] }}\n\nüì¢ <b>–í–ê–ñ–ù–û</b>: <i>—á—Ç–æ–±—ã —É–¥–∞–ª–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç –∑–∞–∫–∞–∑—á–∏–∫–∞ –∏ –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É \"–£–¥–∞–ª–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ\" ! –ü–µ—Ä–µ–π—Ç–∏ –≤ –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç –º–æ–∂–Ω–æ –ø–æ –∫–Ω–æ–ø–∫–µ \"–ú–µ–Ω—é\", —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–Ω–æ–π –≤ –Ω–∏–∂–Ω–µ–º –ª–µ–≤–æ–º —É–≥–ª—É.</i>","additionalFields":{"parse_mode":"HTML"}},"id":"aaef4f03-847c-4b7c-936a-3a1cf9d7120d","name":"Telegram11","type":"n8n-nodes-base.telegram","typeVersion":1,"position":[900,1280],"credentials":{"telegramApi":{"id":"33","name":"–ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å —É—Å–ª—É–≥–∏"}}},{"parameters":{"chatId":"={{ $node[\"Google Sheets13\"].json[\"TG ID\"] }}","text":"=<b>‚ùå –ö–ª–∏–µ–Ω—Ç –∫ —Å–æ–∂–∞–ª–µ–Ω–∏—é –æ—Ç–∫–∞–∑–∞–ª—Å—è –æ—Ç –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è —Ä–∞–±–æ—Ç</b>\n\n{{ $node[\"Code3\"].json[\"aggregatedText\"] }}\n\n\nüì¢ <b>–í–ê–ñ–ù–û</b>: <i>—á—Ç–æ–±—ã —É–¥–∞–ª–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç –∑–∞–∫–∞–∑—á–∏–∫–∞ –∏ –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É \"–£–¥–∞–ª–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ\" ! –ü–µ—Ä–µ–π—Ç–∏ –≤ –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç –º–æ–∂–Ω–æ –ø–æ –∫–Ω–æ–ø–∫–µ \"–ú–µ–Ω—é\", —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–Ω–æ–π –≤ –Ω–∏–∂–Ω–µ–º –ª–µ–≤–æ–º —É–≥–ª—É.</i>","additionalFields":{"parse_mode":"HTML"}},"id":"442632ea-4a0d-45d7-a819-ad4a0518702e","name":"Telegram12","type":"n8n-nodes-base.telegram","typeVersion":1,"position":[900,880],"credentials":{"telegramApi":{"id":"33","name":"–ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å —É—Å–ª—É–≥–∏"}}},{"parameters":{"jsCode":"let message_id = $node[\"Telegram11\"].json[\"result\"][\"message_id\"].toString();\nreturn { message_id }"},"id":"fcbfc783-4660-4fc9-87d2-12a114d31c25","name":"Code5","type":"n8n-nodes-base.code","typeVersion":1,"position":[1060,1280]},{"parameters":{"method":"POST","url":"https://app.leadteh.ru/api/v1/setContactVariable","authentication":"genericCredentialType","genericAuthType":"httpBasicAuth","sendHeaders":true,"headerParameters":{"parameters":[{"name":"X-Requested-With","value":"XMLHttpRequest"}]},"sendBody":true,"bodyParameters":{"parameters":[{"name":"api_token","value":"z3NKDDweLVTcwVNafiHKJUjwcSfTs17D2iGEzgmcIee9oclBLL5xRvqgGIVJ"},{"name":"contact_id","value":"={{ $node[\"Google Sheets7\"].json[\"ID LT master\"] }}"},{"name":"name","value":"notification_master"},{"name":"value","value":"‚ùå –£–¥–∞–ª–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ"},{"name":"deletable","value":"0"}]},"options":{"response":{"response":{"fullResponse":true,"neverError":true,"responseFormat":"text"}}}},"id":"fca05e9b-e2d5-4b68-85d0-5dd7de36b681","name":"HTTP Request3","type":"n8n-nodes-base.httpRequest","typeVersion":4,"position":[1220,1280],"credentials":{"httpBasicAuth":{"id":"35","name":"Unnamed credential"}}},{"parameters":{"method":"POST","url":"https://app.leadteh.ru/api/v1/setContactVariable","authentication":"genericCredentialType","genericAuthType":"httpBasicAuth","sendHeaders":true,"headerParameters":{"parameters":[{"name":"X-Requested-With","value":"XMLHttpRequest"}]},"sendBody":true,"bodyParameters":{"parameters":[{"name":"api_token","value":"z3NKDDweLVTcwVNafiHKJUjwcSfTs17D2iGEzgmcIee9oclBLL5xRvqgGIVJ"},{"name":"contact_id","value":"={{ $node[\"Google Sheets7\"].json[\"ID LT master\"] }}"},{"name":"name","value":"notification_master_id"},{"name":"value","value":"={{ $node[\"Code5\"].json[\"message_id\"] }}"},{"name":"deletable","value":"0"}]},"options":{"response":{"response":{"fullResponse":true,"neverError":true,"responseFormat":"text"}}}},"id":"5dcfaebf-4b80-43a1-98eb-9f7df3efcf9b","name":"HTTP Request4","type":"n8n-nodes-base.httpRequest","typeVersion":4,"position":[1380,1280],"credentials":{"httpBasicAuth":{"id":"35","name":"Unnamed credential"}}},{"parameters":{"jsCode":"let message_id = $node[\"Telegram12\"].json[\"result\"][\"message_id\"].toString();\nreturn { message_id }"},"id":"ce6a27e7-ef6f-4502-bf28-7808e4909ab5","name":"Code6","type":"n8n-nodes-base.code","typeVersion":1,"position":[1060,880]},{"parameters":{"method":"POST","url":"https://app.leadteh.ru/api/v1/setContactVariable","authentication":"genericCredentialType","genericAuthType":"httpBasicAuth","sendHeaders":true,"headerParameters":{"parameters":[{"name":"X-Requested-With","value":"XMLHttpRequest"}]},"sendBody":true,"bodyParameters":{"parameters":[{"name":"api_token","value":"z3NKDDweLVTcwVNafiHKJUjwcSfTs17D2iGEzgmcIee9oclBLL5xRvqgGIVJ"},{"name":"contact_id","value":"={{ $node[\"Google Sheets13\"].json[\"ID LT master\"] }}"},{"name":"name","value":"notification_master"},{"name":"value","value":"‚ùå –£–¥–∞–ª–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ"},{"name":"deletable","value":"0"}]},"options":{"response":{"response":{"fullResponse":true,"neverError":true,"responseFormat":"text"}}}},"id":"4093a7ce-a693-456d-8ca9-63576b57848b","name":"HTTP Request5","type":"n8n-nodes-base.httpRequest","typeVersion":4,"position":[1220,880],"credentials":{"httpBasicAuth":{"id":"35","name":"Unnamed credential"}}},{"parameters":{"method":"POST","url":"https://app.leadteh.ru/api/v1/setContactVariable","authentication":"genericCredentialType","genericAuthType":"httpBasicAuth","sendHeaders":true,"headerParameters":{"parameters":[{"name":"X-Requested-With","value":"XMLHttpRequest"}]},"sendBody":true,"bodyParameters":{"parameters":[{"name":"api_token","value":"z3NKDDweLVTcwVNafiHKJUjwcSfTs17D2iGEzgmcIee9oclBLL5xRvqgGIVJ"},{"name":"contact_id","value":"={{ $node[\"Google Sheets13\"].json[\"ID LT master\"] }}"},{"name":"name","value":"notification_master_id"},{"name":"value","value":"={{ $node[\"Code4\"].json[\"message_id\"] }}"},{"name":"deletable","value":"0"}]},"options":{"response":{"response":{"fullResponse":true,"neverError":true,"responseFormat":"text"}}}},"id":"9d14a17b-2343-4fbc-a341-085d49d5de01","name":"HTTP Request6","type":"n8n-nodes-base.httpRequest","typeVersion":4,"position":[1380,880],"credentials":{"httpBasicAuth":{"id":"35","name":"Unnamed credential"}}},{"parameters":{"chatId":"={{ $node[\"Google Sheets10\"].json[\"TG ID\"] }}","text":"=<b>üëç –ö–ª–∏–µ–Ω—Ç –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª —É—Å–ª–æ–≤–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞—è–≤–∫–∏. –£–¥–∞—á–Ω–æ–π —Ä–∞–±–æ—Ç—ã</b>\n\n{{ $node[\"—Ç–µ–∫—Å—Ç3\"].json[\"aggregatedText\"] }}\n\n\nüì¢ <b>–í–ê–ñ–ù–û</b>: <i>—á—Ç–æ–±—ã —É–¥–∞–ª–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç –∑–∞–∫–∞–∑—á–∏–∫–∞ –∏ –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É \"–£–¥–∞–ª–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ\" ! –ü–µ—Ä–µ–π—Ç–∏ –≤ –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç –º–æ–∂–Ω–æ –ø–æ –∫–Ω–æ–ø–∫–µ \"–ú–µ–Ω—é\", —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–Ω–æ–π –≤ –Ω–∏–∂–Ω–µ–º –ª–µ–≤–æ–º —É–≥–ª—É.</i>","additionalFields":{"parse_mode":"HTML"}},"id":"e6d96708-50d4-4ef6-bf21-7c247921c8d3","name":"Telegram13","type":"n8n-nodes-base.telegram","typeVersion":1,"position":[900,1480],"credentials":{"telegramApi":{"id":"33","name":"–ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å —É—Å–ª—É–≥–∏"}}},{"parameters":{"jsCode":"let message_id = $node[\"Telegram13\"].json[\"result\"][\"message_id\"].toString();\nreturn { message_id }"},"id":"d467c6ba-de96-4efd-aced-f12ab434d63b","name":"Code7","type":"n8n-nodes-base.code","typeVersion":1,"position":[1060,1480]},{"parameters":{"method":"POST","url":"https://app.leadteh.ru/api/v1/setContactVariable","authentication":"genericCredentialType","genericAuthType":"httpBasicAuth","sendHeaders":true,"headerParameters":{"parameters":[{"name":"X-Requested-With","value":"XMLHttpRequest"}]},"sendBody":true,"bodyParameters":{"parameters":[{"name":"api_token","value":"z3NKDDweLVTcwVNafiHKJUjwcSfTs17D2iGEzgmcIee9oclBLL5xRvqgGIVJ"},{"name":"contact_id","value":"={{ $node[\"Google Sheets10\"].json[\"ID LT master\"] }}"},{"name":"name","value":"notification_master"},{"name":"value","value":"‚ùå –£–¥–∞–ª–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ"},{"name":"deletable","value":"0"}]},"options":{"response":{"response":{"fullResponse":true,"neverError":true,"responseFormat":"text"}}}},"id":"1c920b8b-c41b-42c1-be90-fd6ccfff85b5","name":"HTTP Request7","type":"n8n-nodes-base.httpRequest","typeVersion":4,"position":[1220,1480],"credentials":{"httpBasicAuth":{"id":"35","name":"Unnamed credential"}}},{"parameters":{"method":"POST","url":"https://app.leadteh.ru/api/v1/setContactVariable","authentication":"genericCredentialType","genericAuthType":"httpBasicAuth","sendHeaders":true,"headerParameters":{"parameters":[{"name":"X-Requested-With","value":"XMLHttpRequest"}]},"sendBody":true,"bodyParameters":{"parameters":[{"name":"api_token","value":"z3NKDDweLVTcwVNafiHKJUjwcSfTs17D2iGEzgmcIee9oclBLL5xRvqgGIVJ"},{"name":"contact_id","value":"={{ $node[\"Google Sheets10\"].json[\"ID LT master\"] }}"},{"name":"name","value":"notification_master_id"},{"name":"value","value":"={{ $node[\"Code7\"].json[\"message_id\"] }}"},{"name":"deletable","value":"0"}]},"options":{"response":{"response":{"fullResponse":true,"neverError":true,"responseFormat":"text"}}}},"id":"475cfd30-f5d9-4242-984b-7fd2fd14ca22","name":"HTTP Request8","type":"n8n-nodes-base.httpRequest","typeVersion":4,"position":[1380,1480],"credentials":{"httpBasicAuth":{"id":"35","name":"Unnamed credential"}}}],"connections":{"Webhook":{"main":[[{"node":"Code","type":"main","index":0}]]},"Code":{"main":[[{"node":"Switch","type":"main","index":0}]]},"Switch":{"main":[[{"node":"Google Sheets","type":"main","index":0}],[{"node":"Google Sheets1","type":"main","index":0}],[{"node":"IF1","type":"main","index":0}],[{"node":"IF3","type":"main","index":0}]]},"Google Sheets":{"main":[[{"node":"—Ñ–∏–ª—å—Ç—Ä","type":"main","index":0}]]},"IF":{"main":[[{"node":"—É–¥–∞–ª–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ","type":"main","index":0}],[{"node":"–∫–Ω–æ–ø–∫–∏","type":"main","index":0},{"node":"—Ç–µ–∫—Å—Ç","type":"main","index":0}]]},"—Ç–µ–∫—Å—Ç":{"main":[[{"node":"Merge","type":"main","index":0}]]},"–∫–Ω–æ–ø–∫–∏":{"main":[[{"node":"Merge","type":"main","index":1}]]},"Merge":{"main":[[{"node":"—É–¥–∞–ª–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ1","type":"main","index":0}]]},"—Ñ–∏–ª—å—Ç—Ä":{"main":[[{"node":"IF","type":"main","index":0}]]},"Google Sheets1":{"main":[[{"node":"IF2","type":"main","index":0}]]},"—Ç–µ–∫—Å—Ç1":{"main":[[{"node":"—É–¥–∞–ª–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ2","type":"main","index":0}]]},"—É–¥–∞–ª–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ":{"main":[[{"node":"–Ω–µ—Ç –∑–∞—è–≤–æ–∫","type":"main","index":0}]]},"—É–¥–∞–ª–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ1":{"main":[[{"node":"HTTP Request","type":"main","index":0}]]},"—É–¥–∞–ª–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ2":{"main":[[{"node":"Telegram","type":"main","index":0}]]},"Google Sheets2":{"main":[[{"node":"Google Sheets4","type":"main","index":0}]]},"Google Sheets4":{"main":[[{"node":"Google Sheets5","type":"main","index":0}]]},"Google Sheets5":{"main":[[{"node":"Code1","type":"main","index":0}]]},"—É–¥–∞–ª–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ3":{"main":[[{"node":"Telegram1","type":"main","index":0}]]},"Google Sheets3":{"main":[[{"node":"Google Sheets6","type":"main","index":0}]]},"Google Sheets6":{"main":[[{"node":"Google Sheets7","type":"main","index":0}]]},"Google Sheets7":{"main":[[{"node":"Code2","type":"main","index":0}]]},"—É–¥–∞–ª–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ4":{"main":[[{"node":"Telegram2","type":"main","index":0}]]},"Code1":{"main":[[{"node":"—É–¥–∞–ª–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ3","type":"main","index":0}]]},"Code2":{"main":[[{"node":"—É–¥–∞–ª–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ4","type":"main","index":0}]]},"IF2":{"main":[[{"node":"—Ç–µ–∫—Å—Ç2","type":"main","index":0}],[{"node":"Switch1","type":"main","index":0}]]},"—Ç–µ–∫—Å—Ç2":{"main":[[{"node":"—É–¥–∞–ª–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ5","type":"main","index":0}]]},"—É–¥–∞–ª–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ5":{"main":[[{"node":"Telegram3","type":"main","index":0}]]},"IF3":{"main":[[{"node":"Google Sheets3","type":"main","index":0}],[{"node":"Google Sheets8","type":"main","index":0}]]},"Google Sheets8":{"main":[[{"node":"Google Sheets9","type":"main","index":0}]]},"Google Sheets9":{"main":[[{"node":"Google Sheets10","type":"main","index":0}]]},"Google Sheets10":{"main":[[{"node":"—Ç–µ–∫—Å—Ç3","type":"main","index":0}]]},"—Ç–µ–∫—Å—Ç3":{"main":[[{"node":"—É–¥–∞–ª–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ6","type":"main","index":0}]]},"—É–¥–∞–ª–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ6":{"main":[[{"node":"Telegram4","type":"main","index":0}]]},"Switch1":{"main":[[{"node":"—Ç–µ–∫—Å—Ç4","type":"main","index":0}],[{"node":"—Ç–µ–∫—Å—Ç5","type":"main","index":0}],[{"node":"IF4","type":"main","index":0}],[{"node":"—Ç–µ–∫—Å—Ç10","type":"main","index":0}]]},"—Ç–µ–∫—Å—Ç4":{"main":[[{"node":"—É–¥–∞–ª–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ7","type":"main","index":0}]]},"—Ç–µ–∫—Å—Ç5":{"main":[[{"node":"—É–¥–∞–ª–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ8","type":"main","index":0}]]},"—É–¥–∞–ª–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ8":{"main":[[{"node":"Telegram6","type":"main","index":0}]]},"—É–¥–∞–ª–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ7":{"main":[[{"node":"Telegram5","type":"main","index":0}]]},"IF4":{"main":[[{"node":"—Ç–µ–∫—Å—Ç1","type":"main","index":0}],[{"node":"—Ç–µ–∫—Å—Ç6","type":"main","index":0}]]},"—Ç–µ–∫—Å—Ç6":{"main":[[{"node":"—É–¥–∞–ª–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ9","type":"main","index":0}]]},"—É–¥–∞–ª–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ9":{"main":[[{"node":"Telegram7","type":"main","index":0}]]},"IF1":{"main":[[{"node":"Google Sheets11","type":"main","index":0}],[{"node":"Google Sheets2","type":"main","index":0}]]},"Google Sheets11":{"main":[[{"node":"Google Sheets12","type":"main","index":0}]]},"Google Sheets12":{"main":[[{"node":"Google Sheets13","type":"main","index":0}]]},"Google Sheets13":{"main":[[{"node":"Code3","type":"main","index":0}]]},"Code3":{"main":[[{"node":"—É–¥–∞–ª–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ10","type":"main","index":0}]]},"—É–¥–∞–ª–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ10":{"main":[[{"node":"Telegram8","type":"main","index":0}]]},"—Ç–µ–∫—Å—Ç10":{"main":[[{"node":"—É–¥–∞–ª–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ11","type":"main","index":0}]]},"—É–¥–∞–ª–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ11":{"main":[[{"node":"Telegram9","type":"main","index":0}]]},"Telegram1":{"main":[[{"node":"Telegram10","type":"main","index":0}]]},"Telegram10":{"main":[[{"node":"Code4","type":"main","index":0}]]},"Code4":{"main":[[{"node":"HTTP Request1","type":"main","index":0}]]},"HTTP Request1":{"main":[[{"node":"HTTP Request2","type":"main","index":0}]]},"Telegram2":{"main":[[{"node":"Telegram11","type":"main","index":0}]]},"Telegram4":{"main":[[{"node":"Telegram13","type":"main","index":0}]]},"Telegram11":{"main":[[{"node":"Code5","type":"main","index":0}]]},"Code5":{"main":[[{"node":"HTTP Request3","type":"main","index":0}]]},"HTTP Request3":{"main":[[{"node":"HTTP Request4","type":"main","index":0}]]},"Telegram8":{"main":[[{"node":"Telegram12","type":"main","index":0}]]},"Telegram12":{"main":[[{"node":"Code6","type":"main","index":0}]]},"Code6":{"main":[[{"node":"HTTP Request5","type":"main","index":0}]]},"HTTP Request5":{"main":[[{"node":"HTTP Request6","type":"main","index":0}]]},"Telegram13":{"main":[[{"node":"Code7","type":"main","index":0}]]},"Code7":{"main":[[{"node":"HTTP Request7","type":"main","index":0}]]},"HTTP Request7":{"main":[[{"node":"HTTP Request8","type":"main","index":0}]]}},"settings":{},"staticData":null,"meta":null,"pinData":{},"versionId":"24a94fdf-d5b1-4a1e-ad6a-ffa1e30c3639","triggerCount":1,"tags":[]}